## < ABAP 개념 >
</br>

### < Module pool 구조 >
- 모듈풀 프로그램 하나 → 트랜잭션코드 하나와 연결
  
**1) TOP(Include)**
- 전역 변수(Global Variables) 선언
- 화면(Screen)에서 사용할 변수들도 여기에서 선언함

**2) F01 (Include)**
- 로컬 변수(Local Variables)
- FORM 루틴(Function Routines)들 선언

</br>
</br>

---

</br>


## < SCREEN 필드 속성 제어 >
- PAI에서 버튼 클릭 이벤트 발생 → PBO에서 SCREEN 테이블을 수정하여 스크린의 속성 변경 가능
  
  - 입력 가능(Input) → 입력 불가(Output only)
  - Visible → Invisible
  - Active → Inactive 등
</br>
</br>

### < SCREEN 테이블 (헤더라인 있는 INTERNAL TABLE) >
- ABAP 모듈풀에서 스크린 필드 속성을 변경할 때 사용하는 시스템 내부 테이블
</br>
</br>

**1) SCREEN은 헤더라인을 포함한 구조 => `into`절 생략 가능**

- 일반 인터널 테이블
```abap
LOOP AT screen INTO screen.
```
- screen (헤더라인이므로 into절 생략 가능)
```abap
LOOP AT screen.
  " screen-name
  " screen-input
ENDLOOP.
```
</br>
</br>

**2) SCREEN 속성 변경은 `MODIFY SCREEN` 필수**
- SCREEN 내부 테이블에서 특정 필드를 수정하면 반드시 다음 구문을 넣어야 실제 스크린에 반영됨
- 각 필드의 속성에 접근해서 변경할 수 있음
- SCREEN 속성 값은 `1 = TRUE` , `0 = FALSE`

<img width="548" height="365" alt="image" src="https://github.com/user-attachments/assets/e438b436-a6ad-4dae-96d9-a4aaf6bab111" />
</br>
</br>

```abap
MODULE modify_screen OUTPUT.

  LOOP AT SCREEN. 
    IF screen-group1 = 'SEL'.
      screen-input = 1.
    ENDIF.

    IF screen-name = 'FIELD1'.
      screen-active = 0.          " 여기까지는 헤더 부분만 변경. 
    ENDIF.                        " 스크린 변경하고 싶으면 아래 MODIFY를 해줘야 함.
    MODIFY SCREEN.
  ENDLOOP.

ENDMODULE.
```
</br>
</br>

---

</br>

## < 버튼 이벤트 처리 >
</br>

**1) 버튼 생성 후 속성 창에서 FctCode 필드 입력 (펑션코드)**

<img width="433" height="386" alt="image" src="https://github.com/user-attachments/assets/3771a73a-832f-4fb0-a529-83a9880fa9cf" />
</br>
</br>

**2) 입력필드 6개 묶어서 `GROUP1` 지정**

<img width="468" height="376" alt="image" src="https://github.com/user-attachments/assets/0a41e9b3-9292-4a5f-b2f3-7e185c4486b5" />
</br>
</br>

**3) 필드에 `OK_CODE` 추가**

<img width="556" height="336" alt="image" src="https://github.com/user-attachments/assets/1c44dc39-2c62-46b9-a57e-aa36e7081a8b" />
</br>
</br>

**4) 스크린 창에서 모듈 `PBO` , `PAI` 생성**

```abap
PROCESS BEFORE OUTPUT.
 MODULE STATUS_0100.
   MODULE MODIFY_SCREEN.
*
PROCESS AFTER INPUT.
 MODULE USER_COMMAND_0100.
```
</br>

**5) `PBO` - 타이틀에 변수 채워서 설정**

- '&1 &2 &3' : 타이틀에 변수를 설정할 수 있음

<img width="537" height="132" alt="image" src="https://github.com/user-attachments/assets/99b90233-b96f-406d-bc97-1c6d6f792f2c" />
</br>
</br>

**6) `PBO` - 표준 버튼을 어떤 Function Code(OKCODE)로 동작시킬지 설정**

- 이름 지정 시 그 이름으로 `OKCODE` 로 받아서 처리 가능
<img width="591" height="336" alt="image" src="https://github.com/user-attachments/assets/d8a80673-5514-47e1-a54f-bd9d9ed112eb" />

</br>
</br>

**7) `TOP` 모듈 구현**

```abap
*&---------------------------------------------------------------------*
*& Include MZB03002_TOP                             - Module Pool      SAPMZB03002
*&---------------------------------------------------------------------*
PROGRAM sapmzb03002.

TABLES: sdyn_conn.

DATA: ok_code TYPE sy-ucomm,
      gv_mod  TYPE i. " 변경모드 값을 받을 변수
```
</br>

**8) `PAI` 모듈 구현**
```abap
*&---------------------------------------------------------------------*
*& Include          MZB03002_I01
*&---------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_0100  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE user_command_0100 INPUT.
  CASE OK_CODE.
    WHEN 'CHBTN'.
      IF gv_mod = 1.
        gv_mod = 0.
      ELSE.
        gv_mod = 1.
      ENDIF.
    WHEN 'BACK' OR 'EXIT' OR 'CANCEL'.
      LEAVE TO SCREEN 0.
    WHEN OTHERS.
  ENDCASE.
ENDMODULE.
```
</br>

**9) `PBO` 모듈 구현**
```abap
*&---------------------------------------------------------------------*
*& Include          MZB03002_O01
*&---------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*& Module STATUS_0100 OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE status_0100 OUTPUT.
 SET PF-STATUS 'S100'.
 SET TITLEBAR 'T100' WITH sy-datum sy-uzeit sy-uname.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Module MODIFY_SCREEN OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE modify_screen OUTPUT.
  " 헤더가 있는 itab인 SCREEN을 한 건씩 돌면서 동적 처리
  LOOP AT SCREEN.   " INTO SCREEN이 생략
    " SCREEN의 Element 중, group1 값이 'MOD'인 경우
    IF SCREEN-GROUP1 = 'MOD'.
      " Input 속성에 gv_mod 변수 값을 적용함
      SCREEN-INPUT = gv_mod. " 0 또는 1
    ENDIF.

    " Header-Line에 있는 itab 이라서, 작업한 Header를
    " Itab(Body)에 적용시켜야 함
    MODIFY SCREEN. "변경사항 반영
  ENDLOOP.
ENDMODULE.
```
</br>

**9) 결과 확인**

<img width="465" height="316" alt="image" src="https://github.com/user-attachments/assets/32e64b3d-0c48-4144-8e58-5e6b3a007644" />

</br>
</br>
</br>
</br>

---

</br>

## < 실습 코드 >
