## < ABAP 개념 >
</br>

### < ABAP Dynpro CALL SCREEN과 Screen Stack 흐름 >
- **`LEAVE TO SCREEN 0`** 같은 화면 전환 명령은 **`PAI`** 에서만
- **`SCREEN-INPUT`** 같은 화면 속성 변경은 **`PBO`** 에서만
- 사용자 입력 기반 SELECT는 **`PAI`** , 조회 결과 화면 반영/속성 변경은 **`PBO`**
- **OK_CODE 초기화** 코드 꼭 넣어줘야 함 ( 보통 **`PBO`** 에서)
```abap
MODULE clear_ok_code OUTPUT.
  CLEAR: OK_CODE.
ENDMODULE.
```

<img width="584" height="323" alt="image" src="https://github.com/user-attachments/assets/2fc3f75c-acfe-4c79-82c7-fd88c67b058c" />
</br>
</br>

---

</br>

## < 사용자 인터페이스(UI) 구성 기능 >
</br>

### 1) SET CURSOR FIELD 
- 특정 화면 필드에 포커스를 이동시킴
- `<field_name>` : 화면(Screen)에 존재하는 필드 이름
```abap
SET CURSOR FIELD <field_name>.
```
```abap
SET CURSOR FIELD 'SDYN_CONN-CONNID'.
```
</br>

<img width="462" height="304" alt="image" src="https://github.com/user-attachments/assets/75fa9c97-ee46-4f0a-845d-5fd0105b82fa" />
</br>
</br>

<img width="423" height="303" alt="image" src="https://github.com/user-attachments/assets/ea8a1738-c120-4564-a8df-d43f12b70b24" />
</br>
</br>
</br>
</br>

### 2) Function Key / Function type
**2-1) Function Type**
- 종류: `NORMAL / EXIT / TABSTRIP CTRL`
  - 기본값: NORMAL
- Function Type을 비워두면 `NORMAL` 로 처리됨
</br>

- `PF-STATUS` 에서 더블클릭시 function key 및 function code 지정 가능
  
<img width="581" height="216" alt="image" src="https://github.com/user-attachments/assets/9f6448b4-e07b-4a84-bbc1-b4de4aa160c8" />
</br>
</br>

- `function type` 에 따라 저기에 들어가는 내용이 달라짐
  
<img width="656" height="123" alt="image" src="https://github.com/user-attachments/assets/9c6e14cc-89de-4fd6-84fd-09bcd9beb981" />

</br>
</br>

- `PF-STATUS` 를 통한 펑션코드와 속성 설정 예시
  
<img width="577" height="387" alt="image" src="https://github.com/user-attachments/assets/8c638b9d-3e57-4e2d-a325-b5c2e15e1f18" />

</br>
</br>

---

</br>

## < 실습 코드 >

### 실습 1
- 문제 ( ABAP Dynpro CALL SCREEN과 Screen Stack 흐름 )

<img width="436" height="226" alt="image" src="https://github.com/user-attachments/assets/9ce0443e-acaf-408a-a37a-e43a75d932fa" />
</br>
</br>

**1) 각 스크린의 `Layout` 설정**
- `Screen 100`
<img width="303" height="183" alt="image" src="https://github.com/user-attachments/assets/3143132f-d12f-40c8-8247-f67a222bd64e" />
</br>
</br>

- `Screen 200`
<img width="321" height="281" alt="image" src="https://github.com/user-attachments/assets/439391c4-5f02-4fbd-9386-15c2c4e57460" />
</br>
</br>
</br>

**2) `TOP` 모듈 생성**
```abap
*&---------------------------------------------------------------------*
*& Include MZPRACTICE03B03_TOP                      - Module Pool      SAPMZPRACTICE03B03
*&---------------------------------------------------------------------*
PROGRAM SAPMZPRACTICE03B03.

TABLES: ZSCARRFLIGHT_B03.

DATA: OK_CODE TYPE sy-ucomm,
      gv_carrid TYPE ZSCARRFLIGHT_B03-CARRID,
      gv_connid TYPE ZSCARRFLIGHT_B03-CONNID,
      gv_fldate TYPE ZSCARRFLIGHT_B03-FLDATE,
      gs_data TYPE ZSCARRFLIGHT_B03.
```
</br>

**3) `F01` 모듈 생성**
```abap
*&---------------------------------------------------------------------*
*& Include          MZPRACTICE03B03_F01
*&---------------------------------------------------------------------*

FORM get_data USING pa_carrid pa_connid pa_fldate
              CHANGING gt_data.

  SELECT SINGLE A~CARRID, A~CARRNAME, A~CURRCODE, B~CONNID, B~FLDATE, B~PRICE, B~CURRENCY, B~PLANETYPE, B~SEATSMAX, B~SEATSOCC
    INTO @gs_data
    FROM scarr AS A INNER JOIN sflight AS B
      ON A~carrid = B~carrid
    WHERE B~carrid = @pa_carrid
      AND B~connid = @pa_connid
      AND B~fldate = @pa_fldate.
  MOVE-CORRESPONDING gs_data TO ZSCARRFLIGHT_B03.

ENDFORM.
```
</br>


**4) `PBO` 모듈 생성**
```abap
*&---------------------------------------------------------------------*
*& Include          MZPRACTICE03B03_O01
*&---------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*& Module STATUS_0100 OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE status_0100 OUTPUT.
* SET PF-STATUS 'xxxxxxxx'.
* SET TITLEBAR 'xxx'.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Module STATUS_0200 OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE status_0200 OUTPUT.
  PERFORM get_data USING gv_carrid gv_connid gv_fldate
                   CHANGING gs_data.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Module clear_ok_code OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE clear_ok_code OUTPUT.
  CLEAR: OK_CODE.
ENDMODULE.
```
</br>

**5) `PAI` 모듈 생성**
```abap
*&---------------------------------------------------------------------*
*& Include          MZPRACTICE03B03_I01
*&---------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_0100  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE user_command_0100 INPUT.
  gv_carrid = ZSCARRFLIGHT_B03-CARRID.
  gv_connid = ZSCARRFLIGHT_B03-CONNID.
  gv_fldate = ZSCARRFLIGHT_B03-FLDATE.

  CALL SCREEN 200.
ENDMODULE.
*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_0200  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE user_command_0200 INPUT.
  IF OK_CODE = 'MOVE'.
    LEAVE TO SCREEN 0.
  ENDIF.
ENDMODULE.
```
