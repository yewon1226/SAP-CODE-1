## < ABAP 개념 >
</br>

### < ABAP Dynpro CALL SCREEN과 Screen Stack 흐름 >
- **`LEAVE TO SCREEN 0`** 같은 화면 전환 명령은 **`PAI`** 에서만
- **`SCREEN-INPUT`** 같은 화면 속성 변경은 **`PBO`** 에서만
- 사용자 입력 기반 SELECT는 **`PAI`** , 조회 결과 화면 반영/속성 변경은 **`PBO`**
- **OK_CODE 초기화** 코드 꼭 넣어줘야 함 ( 보통 **`PBO`** 에서)
```abap
MODULE clear_ok_code OUTPUT.
  CLEAR: OK_CODE.
ENDMODULE.
```

<img width="584" height="323" alt="image" src="https://github.com/user-attachments/assets/2fc3f75c-acfe-4c79-82c7-fd88c67b058c" />
</br>
</br>

---

</br>

## < 사용자 인터페이스(UI) 구성 기능 >
</br>

### 1) SET CURSOR FIELD 
- 특정 화면 필드에 포커스를 이동시킴
- `<field_name>` : 화면(Screen)에 존재하는 필드 이름
```abap
SET CURSOR FIELD <field_name>.
```
```abap
SET CURSOR FIELD 'SDYN_CONN-CONNID'.
```
</br>

<img width="462" height="304" alt="image" src="https://github.com/user-attachments/assets/75fa9c97-ee46-4f0a-845d-5fd0105b82fa" />
</br>
</br>

<img width="423" height="303" alt="image" src="https://github.com/user-attachments/assets/ea8a1738-c120-4564-a8df-d43f12b70b24" />
</br>
</br>
</br>
</br>

### 2) Function Key / Function type ( PF-STATUS - PBO에서 설정 )
**2-1) Function Type**
- 종류: `NORMAL / EXIT / TABSTRIP CTRL`
  - 기본값: NORMAL
- Function Type을 비워두면 `NORMAL` 로 처리됨
</br>

- `PF-STATUS` 에서 더블클릭시 function key 및 function code 지정 가능
  
<img width="581" height="216" alt="image" src="https://github.com/user-attachments/assets/9f6448b4-e07b-4a84-bbc1-b4de4aa160c8" />
</br>
</br>

- `function type` 에 따라 저기에 들어가는 내용이 달라짐
  
<img width="656" height="123" alt="image" src="https://github.com/user-attachments/assets/9c6e14cc-89de-4fd6-84fd-09bcd9beb981" />

</br>
</br>

- `PF-STATUS` 를 통한 펑션코드와 속성 설정 예시
  
<img width="577" height="387" alt="image" src="https://github.com/user-attachments/assets/8c638b9d-3e57-4e2d-a325-b5c2e15e1f18" />
</br>
</br>
</br>
</br>

### 3) Titlebar ( TITLEBAR - PBO에서 설정 )
- `All Title` 선택 시 모든 스크린에 동일 적용

<img width="605" height="148" alt="image" src="https://github.com/user-attachments/assets/ab7604b0-4567-4dc4-980a-e714ae96d91f" />
</br>
</br>
</br>
</br>


</br>
</br>

---

</br>

## < PF-STATUS 및 Dialog 스크린 예제 >
**1) 각 스크린 코드에서 모듈 생성**
- CLEAR_OK_CODE. 모듈을 전부 선언해주어 OK_CODE를 클리어 시킴.
</br>

- 100 스크린
```abap
PROCESS BEFORE OUTPUT.
 MODULE STATUS_0100.
 MODULE CLEAR_OK_CODE.
*
PROCESS AFTER INPUT.
 MODULE USER_COMMAND_0100.
```
- 110 스크린
```abap
PROCESS BEFORE OUTPUT.
 MODULE STATUS_0110.
 MODULE CLEAR_OK_CODE.
*
PROCESS AFTER INPUT.
 MODULE USER_COMMAND_0110.
```
- 200 스크린
```abap
PROCESS BEFORE OUTPUT.
 MODULE STATUS_0200.
 MODULE CLEAR_OK_CODE.
*
PROCESS AFTER INPUT.
 MODULE USER_COMMAND_0100.
```
</br>
</br>
</br>

**2) `100 Screen` PF-STATUS, TITLEBAR 생성**
- `Menu Bar` 설정
- 최대 3레벨, 최대 15개까지 가능

<img width="630" height="331" alt="image" src="https://github.com/user-attachments/assets/8bfe8db3-3162-4493-8349-baa50eb07cdc" />
</br>
</br>

<img width="490" height="207" alt="image" src="https://github.com/user-attachments/assets/8df34555-8d7b-44b8-92ae-acf189e84b3d" />
</br>
</br>

- `Application Toolbar` 설정
<img width="688" height="283" alt="image" src="https://github.com/user-attachments/assets/6256a641-bea8-412f-8963-af18ed670eae" />
</br>
</br>

<img width="702" height="239" alt="image" src="https://github.com/user-attachments/assets/e2f6a8e3-2bcf-4d7a-83d1-e09d127d845f" />
</br>
</br>

<img width="616" height="286" alt="image" src="https://github.com/user-attachments/assets/2273da92-2d35-4198-8c4e-5bcb08e15c6d" />
</br>
</br>

<img width="341" height="169" alt="image" src="https://github.com/user-attachments/assets/eafc8069-42b9-41ea-9101-9f3b4ae584b8" />
</br>
</br>

- `Function Keys` 설정

<img width="648" height="312" alt="image" src="https://github.com/user-attachments/assets/0e476e6d-c8a1-492f-b5dc-b0c90c7621cc" />
</br>
</br>

- `TITLEBAR` 생성
- `&1` 이용해 변수 넣기
  
<img width="583" height="140" alt="image" src="https://github.com/user-attachments/assets/c1f8d966-6167-410d-bf12-f8bb4ec705be" />
</br>
</br>

<img width="386" height="177" alt="image" src="https://github.com/user-attachments/assets/9a38a8ad-5c66-4096-8263-4f49c3ab4c0b" />

</br>
</br>
</br>
</br>

**3) `110 Screen` PF-STATUS 생성 (Dialog)**
- 생성할 때 `Normal` 대신 `Dialog Box` 선택
<img width="514" height="327" alt="image" src="https://github.com/user-attachments/assets/a07132ec-45b0-4431-8018-3930f08a6824" />
</br>
</br>

- `Application Toolbar` 설정
  
<img width="692" height="335" alt="image" src="https://github.com/user-attachments/assets/dddd6815-ae4b-478f-ab33-00747919ed0d" />
</br>
</br>

- `Layout` 설정
<img width="543" height="349" alt="image" src="https://github.com/user-attachments/assets/9ed62e47-491d-45f0-b27b-ce749cc0e054" />
</br>
</br>
</br>
</br>

**4) `PBO` 모듈 생성**
```abap
*&---------------------------------------------------------------------*
*& Include          MZB03004_O01
*&---------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*& Module STATUS_0100 OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE status_0100 OUTPUT.
 SET PF-STATUS 'S100'.
 SET TITLEBAR 'T100' WITH sy-dynnr.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Module CLEAR_OK_CODE OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE clear_ok_code OUTPUT.
  CLEAR: OK_CODE.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Module STATUS_0200 OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE status_0200 OUTPUT.
 SET PF-STATUS 'S200'.
 SET TITLEBAR 'T100' WITH sy-dynnr.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Module STATUS_0110 OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE status_0110 OUTPUT.
 SET PF-STATUS 'S110'.
 SET TITLEBAR 'T100' WITH sy-dynnr.
ENDMODULE.
```
</br>
</br>
</br>

**5) `PAI` 모듈 생성**
```abap
*&---------------------------------------------------------------------*
*& Include          MZB03004_I01
*&---------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_0100  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE user_command_0100 INPUT.
  CASE OK_CODE.
    WHEN 'BACK'.
      LEAVE TO SCREEN 0.
    WHEN 'EXIT' OR 'CANCEL'.
      LEAVE PROGRAM.
    WHEN 'MOVE'.
      SET SCREEN 200.
      LEAVE SCREEN.
      " LEAVE TO SCREEN 200. 과 동일
    WHEN 'REMARK'.
*      MESSAGE 'Remark 메뉴 선택' TYPE 'I'.
      CALL SCREEN 110
      STARTING AT 5 5
      ENDING AT 50 10.
    WHEN OTHERS.
  ENDCASE.
ENDMODULE.
*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_0110  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE user_command_0110 INPUT.
  CASE OK_CODE.
    WHEN 'OK'.
      MESSAGE 'OK 클릭' TYPE 'I'.
    WHEN 'CLOSE'.
      MESSAGE 'CLOSE 클릭' TYPE 'I'.
    WHEN 'DISP'.
      MESSAGE 'DISP 클릭' TYPE 'I'.
    WHEN OTHERS.
  ENDCASE.
ENDMODULE.
```
</br>
</br>
</br>

---

</br>

## < 실습 코드 >

### 실습 1
- 문제 ( ABAP Dynpro CALL SCREEN과 Screen Stack 흐름 )

<img width="436" height="226" alt="image" src="https://github.com/user-attachments/assets/9ce0443e-acaf-408a-a37a-e43a75d932fa" />
</br>
</br>

**1) 각 스크린의 `Layout` 설정**
- `Screen 100`
<img width="303" height="183" alt="image" src="https://github.com/user-attachments/assets/3143132f-d12f-40c8-8247-f67a222bd64e" />
</br>
</br>

- `Screen 200`
<img width="321" height="281" alt="image" src="https://github.com/user-attachments/assets/439391c4-5f02-4fbd-9386-15c2c4e57460" />
</br>
</br>
</br>

**2) `TOP` 모듈 생성**
```abap
*&---------------------------------------------------------------------*
*& Include MZPRACTICE03B03_TOP                      - Module Pool      SAPMZPRACTICE03B03
*&---------------------------------------------------------------------*
PROGRAM SAPMZPRACTICE03B03.

TABLES: ZSCARRFLIGHT_B03.

DATA: OK_CODE TYPE sy-ucomm,
      gv_carrid TYPE ZSCARRFLIGHT_B03-CARRID,
      gv_connid TYPE ZSCARRFLIGHT_B03-CONNID,
      gv_fldate TYPE ZSCARRFLIGHT_B03-FLDATE,
      gs_data TYPE ZSCARRFLIGHT_B03.
```
</br>

**3) `F01` 모듈 생성**
```abap
*&---------------------------------------------------------------------*
*& Include          MZPRACTICE03B03_F01
*&---------------------------------------------------------------------*

FORM get_data USING pa_carrid pa_connid pa_fldate
              CHANGING gt_data.

  SELECT SINGLE A~CARRID, A~CARRNAME, A~CURRCODE, B~CONNID, B~FLDATE, B~PRICE, B~CURRENCY, B~PLANETYPE, B~SEATSMAX, B~SEATSOCC
    INTO @gs_data
    FROM scarr AS A INNER JOIN sflight AS B
      ON A~carrid = B~carrid
    WHERE B~carrid = @pa_carrid
      AND B~connid = @pa_connid
      AND B~fldate = @pa_fldate.
  MOVE-CORRESPONDING gs_data TO ZSCARRFLIGHT_B03.

ENDFORM.
```
</br>


**4) `PBO` 모듈 생성**
```abap
*&---------------------------------------------------------------------*
*& Include          MZPRACTICE03B03_O01
*&---------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*& Module STATUS_0100 OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE status_0100 OUTPUT.
* SET PF-STATUS 'xxxxxxxx'.
* SET TITLEBAR 'xxx'.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Module STATUS_0200 OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE status_0200 OUTPUT.
  PERFORM get_data USING gv_carrid gv_connid gv_fldate
                   CHANGING gs_data.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Module clear_ok_code OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE clear_ok_code OUTPUT.
  CLEAR: OK_CODE.
ENDMODULE.
```
</br>

**5) `PAI` 모듈 생성**
```abap
*&---------------------------------------------------------------------*
*& Include          MZPRACTICE03B03_I01
*&---------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_0100  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE user_command_0100 INPUT.
  gv_carrid = ZSCARRFLIGHT_B03-CARRID.
  gv_connid = ZSCARRFLIGHT_B03-CONNID.
  gv_fldate = ZSCARRFLIGHT_B03-FLDATE.

  CALL SCREEN 200.
ENDMODULE.
*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_0200  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE user_command_0200 INPUT.
  IF OK_CODE = 'MOVE'.
    LEAVE TO SCREEN 0.
  ENDIF.
ENDMODULE.
```
</br>
</br>

### 실습 2
