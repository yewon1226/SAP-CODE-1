## <  í•µì‹¬ ê°œë… >
</br>

- **1) ALV ë°ì´í„° ê°±ì‹  (refresh_table_display, stable)**
- **2) ALV ë ˆì´ì•„ì›ƒ ì„¤ì • (IS_LAYOUT)**
- **3) ALV ì„ê³„ê°’(Threshold) ì•„ì´ì½˜ í‘œì‹œ â€“ Exception Display (íŠ¹ì • ì¡°ê±´ì— ë”°ë¼ ë¹¨ê°•/ë…¸ë‘/ì´ˆë¡ ì•„ì´ì½˜ ìë™ í‘œì‹œ)**
- **4) ALV ì´ˆê¸° ì •ë ¬ ê¸°ì¤€ ì„¤ì • (lvc_s_sort)**
- **5) ALV ì´ˆê¸° í•„í„° ì¡°ê±´ ì„¤ì • (LVC_S_FILT)**
- **6) ALV Line Color (í–‰ ìƒ‰ìƒ ì œì–´)**
- **7) ALV Cell Color (ì…€ ë‹¨ìœ„ ìƒ‰ìƒ ì œì–´)**
</br>

- **SELECT-OPTIONSëŠ” `Selection Screen` ì—ì„œë§Œ ê°€ëŠ¥**
- **`TYPE-POOLS COL.` ë¡œ ìƒ‰ìƒ ì½”ë“œ í™•ì¸ ê°€ëŠ¥ (í•„ìˆ˜)**

</br>
</br>

---

</br>

## < ABAP ê°ì²´ ìƒì„± ê¸°ë³¸ ë¬¸ë²• >
</br>

### 1) ALV ë°ì´í„° ê°±ì‹ 
- ì´ë¯¸ ìƒì„±ëœ ALV Gridê°€ ìˆì„ ë•Œ ALVë¥¼ ë‹¤ì‹œ ìƒì„±í•˜ì§€ ì•Šê³  ë°ì´í„°ë§Œ í™”ë©´ì— ë°˜ì˜
- `LVC_S_STBL` : ALV ìƒˆë¡œê³ ì¹¨ ì‹œ í™”ë©´ ìœ„ì¹˜ ê³ ì •ìš© êµ¬ì¡°
- `row = 'X'` â†’ í–‰(ìŠ¤í¬ë¡¤) ìœ„ì¹˜ ìœ ì§€
- `col = 'X'` â†’ ì—´(ì»¤ì„œ) ìœ„ì¹˜ ìœ ì§€
</br>

- `REFRESH_TABLE_DISPLAY` â†’ ALV Grid ë°ì´í„°ë¥¼ ë‹¤ì‹œ ê·¸ë¦¬ë˜ ìŠ¤í¬ë¡¤Â·ì„ íƒ ìƒíƒœë¥¼ ìœ ì§€í•œ ì±„ í™”ë©´ë§Œ ê°±ì‹ í•˜ëŠ” ë©”ì„œë“œ
- `i_soft_refresh` = 'X' : ì •ë ¬Â·í•„í„°Â·ë ˆì´ì•„ì›ƒì„ ìœ ì§€í•œ ì±„ ë°ì´í„°ë§Œ ê°±ì‹ 
- `i_soft_refresh` = space : ALVë¥¼ ì „ì²´ ì¬ê³„ì‚°í•˜ì—¬ ì •ë ¬Â·í•„í„°ê¹Œì§€ ë‹¤ì‹œ ì ìš©
```abap
********* TOP *********
DATA ls_stable TYPE lvc_s_stbl.    

********* PBO *********
ls_stable-row = 'X'.   " í–‰(ìŠ¤í¬ë¡¤) ìœ„ì¹˜ ìœ ì§€
ls_stable-col = 'X'.   " ì—´(ì»¤ì„œ) ìœ„ì¹˜ ìœ ì§€

CALL METHOD go_alv->refresh_table_display
  EXPORTING
    is_stable      = ls_stable
    i_soft_refresh = 'X'   " ì •ë ¬Â·í•„í„°Â·ë ˆì´ì•„ì›ƒ ìœ ì§€
  EXCEPTIONS
    finished       = 1
    others         = 2.
```
</br>
</br>
</br>

### 2) ALV ë ˆì´ì•„ì›ƒ ì„¤ì • (IS_LAYOUT)
- ALV Gridì˜ í™”ë©´ ëª¨ì–‘(ì œëª©, ì¤„ë¬´ëŠ¬, ì»¬ëŸ¼ í­ ë“±)ì„ ì„¤ì •
- ë°ì´í„° ë‚´ìš©ì€ ì•ˆ ë°”ë€Œê³  í‘œì‹œ ë°©ì‹ë§Œ ì œì–´
- `SET_TABLE_FOR_FIRST_DISPLAY` ì—ì„œ ìµœì´ˆ ì¶œë ¥ ì‹œë§Œ ì ìš©
- **`Ctrl + Space`** - `gs_layout-` ë’¤ì—ì„œ ëˆ„ë¥´ë©´ êµ¬ì¡°ì²´ í•„ë“œ ëª©ë¡ ìë™ í‘œì‹œ
</br>

- `LVC_S_LAYO` : ALV í™”ë©´ì˜ ëª¨ì–‘(ë ˆì´ì•„ì›ƒ) ì„ ì œì–´í•˜ëŠ” êµ¬ì¡°ì²´
```abap
DATA <ls_layout> TYPE lvc_s_layo.

<ls_layout>-grid_title = 'Booking List'.
<ls_layout>-zebra      = 'X'.
<ls_layout>-cwidth_opt = 'X'.
<ls_layout>-totals_bef = 'X'.
<ls_layout>-sel_mode   = 'A'.

CALL METHOD <alv_ref>->set_table_for_first_display
  EXPORTING
    i_structure_name = '<DDIC>'
    is_layout        = <ls_layout>
  CHANGING
    it_outtab        = <itab>.
```
```abap
********* TOP *********
DATA gs_layout TYPE lvc_s_layo.

********* F01 *********
FORM set_layout.
  gs_layout-grid_title = 'Booking List'.   " ALV ì œëª©
  gs_layout-zebra      = 'X'.               " í–‰ ì¤„ë¬´ëŠ¬
  gs_layout-cwidth_opt = 'X'.               " ì»¬ëŸ¼ ë„ˆë¹„ ìë™
  gs_layout-totals_bef = 'X'.               " í•©ê³„ ìƒë‹¨
  gs_layout-sel_mode   = 'A'.               " ì„ íƒ ëª¨ë“œ (_,A,B,C,D)
ENDFORM.

********* PBO *********
CALL METHOD go_alv->set_table_for_first_display
  EXPORTING
    i_structure_name = 'SBOOK'
    is_layout        = gs_layout
  CHANGING
    it_outtab        = gt_data.
```
</br>
</br>

**< LVC_S_LAYO (ALV Layout Structure ì£¼ìš” í•„ë“œ ì •ë¦¬) >**
  
| Field Name     | Description |
|---------------|-------------|
| `grid_title`  | ALV ìƒë‹¨ì— í‘œì‹œë˜ëŠ” ì œëª© í…ìŠ¤íŠ¸ (ìµœëŒ€ 70ì) |
| `zebra`       | `'X'` ì„¤ì • ì‹œ í–‰ì„ êµì°¨ ìƒ‰ìƒ(Zebra íŒ¨í„´)ìœ¼ë¡œ í‘œì‹œ |
| `no_headers`  | `'X'` ì„¤ì • ì‹œ ì»¬ëŸ¼ í—¤ë” ìˆ¨ê¹€ |
| `sel_mode`    | í–‰ / ì…€ / ì»¬ëŸ¼ ì„ íƒ ëª¨ë“œ ì„¤ì • |
| `cwidth_opt`  | `'X'` ì„¤ì • ì‹œ ì»¬ëŸ¼ í­ ìë™ ìµœì í™” |
| `no_toolbar`  | `'X'` ì„¤ì • ì‹œ ALV íˆ´ë°” ìˆ¨ê¹€ |
| `totals_bef`  | `'X'` ì„¤ì • ì‹œ í•©ê³„ í–‰ì„ ë°ì´í„° ë§¨ ìœ„ì— í‘œì‹œ |
| `no_hgridln`  | `'X'` ì„¤ì • ì‹œ ê°€ë¡œ(Grid) ë¼ì¸ ìˆ¨ê¹€ |
| `no_vgridln`  | `'X'` ì„¤ì • ì‹œ ì„¸ë¡œ(Grid) ë¼ì¸ ìˆ¨ê¹€ |
| `info_fname`  | **í–‰(Row) ìƒ‰ìƒ ì •ë³´**ë¥¼ ë‹´ê³  ìˆëŠ” ë‚´ë¶€ í…Œì´ë¸” í•„ë“œëª… |
| `ctab_fname`  | **ì…€(Cell) ìƒ‰ìƒ ì •ë³´**ë¥¼ ë‹´ê³  ìˆëŠ” ë‚´ë¶€ í…Œì´ë¸” í•„ë“œëª… |

</br>

**< ALV Selection Mode (lvc_s_layo-sel_mode) >**

| ê°’(Value) | ì„ íƒ ê°€ëŠ¥ ë²”ìœ„ (Possible Selections) | ì„ íƒ ì»¬ëŸ¼ í‘œì‹œ (Selection Column) |
|-----------|--------------------------------------|-----------------------------------|
| space     | Bì™€ ë™ì¼                              | No                                |
| A         | ë‹¤ì¤‘ í–‰ ì„ íƒ<br>ë‹¤ì¤‘ ì»¬ëŸ¼ ì„ íƒ        | Yes                               |
| B         | ë‹¨ì¼ í–‰ ì„ íƒ<br>ë‹¤ì¤‘ ì»¬ëŸ¼ ì„ íƒ        | No                                |
| C         | ë‹¤ì¤‘ í–‰ ì„ íƒ<br>ë‹¤ì¤‘ ì»¬ëŸ¼ ì„ íƒ        | No                                |
| D         | ë‹¤ì¤‘ í–‰ ì„ íƒ<br>ë‹¤ì¤‘ ì»¬ëŸ¼ ì„ íƒ<br>ì…€ ë‹¨ìœ„ ì„ íƒ ê°€ëŠ¥ | Yes |

</br>
</br>
</br>

### 3) ALV ì„ê³„ê°’(Threshold) ì•„ì´ì½˜ í‘œì‹œ â€“ Exception Display
- íŠ¹ì • ì¡°ê±´ì— ë”°ë¼ ë¹¨ê°•/ë…¸ë‘/ì´ˆë¡ ì•„ì´ì½˜ ìë™ í‘œì‹œ
- `excp_fname` : ì˜ˆì™¸(ì•„ì´ì½˜) ê°’ì„ ë‹´ê³  ìˆëŠ” ì»¬ëŸ¼ ì´ë¦„ì„ ALVì— ì•Œë ¤ì¤Œ
- `excp_led` : í•´ë‹¹ ì»¬ëŸ¼ ê°’ì„ ì‹ í˜¸ë“±(LED) ì•„ì´ì½˜ìœ¼ë¡œ í‘œì‹œí•˜ë„ë¡ ì„¤ì •
- ALV Exception ì»¬ëŸ¼ì€ `1 = ë¹¨ê°•` , `2 = ë…¸ë‘` , `3 = ì´ˆë¡`
```abap
gs_layout-excp_fname = '<ì˜ˆì™¸ì»¬ëŸ¼ëª…>'.
gs_layout-excp_led   = 'X'.

CALL METHOD <alv_ref>->set_table_for_first_display
  EXPORTING
    is_layout = gs_layout
  CHANGING
    it_outtab = <itab>.

*&---------------------------------------------------------------------*

LOOP AT <itab> INTO <wa>.
  IF <ì¡°ê±´1>.
    <wa>-<excp_field> = '1'.
  ELSEIF <ì¡°ê±´2>.
    <wa>-<excp_field> = '2'.
  ELSE.
    <wa>-<excp_field> = '3'.
  ENDIF.

  MODIFY <itab> FROM <wa> TRANSPORTING <excp_field>.
ENDLOOP.
```
```abap
" ì˜ˆì™¸ í‘œì‹œìš© ì»¬ëŸ¼ëª… ì§€ì •
gs_layout-excp_fname = 'EXCP_FLD'.  " ì•„ì´ì½˜ ê°’ì´ ë“¤ì–´ìˆëŠ” í•„ë“œ
gs_layout-excp_led   = 'X'.         " LED(ì‹ í˜¸ë“±) ì•„ì´ì½˜ ì‚¬ìš©

CALL METHOD go_alv->set_table_for_first_display
  EXPORTING
    i_structure_name = 'SFLIGHT'
    is_layout        = gs_layout
  CHANGING
    it_outtab        = gt_flights.

*&---------------------------------------------------------------------*

LOOP AT gt_flights INTO gs_flight.

  IF gs_flight-seatsocc < 50.
    gs_flight-excp = '1'.   " ğŸ”´ ë¹¨ê°•
  ELSEIF gs_flight-seatsocc <= 200.
    gs_flight-excp = '2'.   " ğŸŸ¡ ë…¸ë‘
  ELSE.
    gs_flight-excp = '3'.   " ğŸŸ¢ ì´ˆë¡
  ENDIF.

  MODIFY gt_flights FROM gs_flight TRANSPORTING excp.
  CLEAR gs_flight.

ENDLOOP.
```
</br>
</br>
</br>

### 4) ALV ì´ˆê¸° ì •ë ¬ ê¸°ì¤€ ì„¤ì • (lvc_s_sort)
- ALV ìµœì´ˆ ì¶œë ¥ ì‹œ ì •ë ¬ ê¸°ì¤€ì„ ì§€ì •
- **`set_sorter_criteria` ëŠ” ì´ë¯¸ ìƒì„±ëœ ALV Gridì— ì •ë ¬ ê¸°ì¤€ë§Œ ìƒˆë¡œ ì ìš©í•˜ëŠ” ë©”ì„œë“œ**
</br>

- `lvc_s_sort` : ì •ë ¬ ê¸°ì¤€ 1ê°œ, `lvc_t_sort` : ì •ë ¬ ê¸°ì¤€ ì—¬ëŸ¬ ê°œë¥¼ ë‹´ëŠ” í…Œì´ë¸”
- `spos` : ì •ë ¬ ìš°ì„ ìˆœìœ„ (1, 2, 3 â€¦)
- `up = 'X'` : ì˜¤ë¦„ì°¨ìˆœ, `down = 'X'` : ë‚´ë¦¼ì°¨ìˆœ
- `SUBTOT = 'X'` : í•´ë‹¹ ì •ë ¬ í•„ë“œ ê¸°ì¤€ìœ¼ë¡œ ì†Œê³„(Subtotal) ë¼ì¸ì„ ì¶œë ¥. `DO_SUM = 'X'` ê°€ ì„¤ì •ëœ í•©ê³„ ëŒ€ìƒ í•„ë“œê°€ ìˆì–´ì•¼ ì‹¤ì œ ì†Œê³„ ê°’ì´ ê³„ì‚°Â·ì¶œë ¥ë¨.
```abap
DATA: gt_sort TYPE lvc_t_sort,
      gs_sort TYPE lvc_s_sort.

gs_sort-fieldname = '<FIELD_NAME>'.
gs_sort-spos      = <ìˆœë²ˆ>.
gs_sort-up        = 'X'.   " ë˜ëŠ” gs_sort-down = 'X'
APPEND gs_sort TO gt_sort.
CLEAR gs_sort.

CALL METHOD <alv_ref>->set_table_for_first_display
  EXPORTING
    i_structure_name = '<DDIC>'
  CHANGING
    it_outtab = <itab>
    it_sort   = gt_sort.
```
```abap
DATA: gt_sort TYPE lvc_t_sort,
      gs_sort TYPE lvc_s_sort.

" 1ìˆœìœ„: ORDER_DATE ì˜¤ë¦„ì°¨ìˆœ
gs_sort-fieldname = 'ORDER_DATE'.
gs_sort-spos      = 1.
gs_sort-up        = 'X'.
APPEND gs_sort TO gt_sort.
CLEAR gs_sort.

" 2ìˆœìœ„: CUSTOMID ì˜¤ë¦„ì°¨ìˆœ
gs_sort-fieldname = 'CUSTOMID'.
gs_sort-spos      = 2.
gs_sort-up        = 'X'.
APPEND gs_sort TO gt_sort.

CALL METHOD go_alv_grid->set_table_for_first_display
  EXPORTING
    i_structure_name = 'SBOOK'
  CHANGING
    it_outtab = gt_bookings
    it_sort   = gt_sort.
```
</br>
</br>
</br>

### 5) ALV ì´ˆê¸° í•„í„° ì¡°ê±´ ì„¤ì • (LVC_S_FILT)
- ALV ìµœì´ˆ ì¶œë ¥ ì‹œ íŠ¹ì • ì¡°ê±´ìœ¼ë¡œ ë°ì´í„° í•„í„°ë§
- **`set_filter_criteria` ëŠ” ì´ë¯¸ ìƒì„±ëœ ALV Gridì— í•„í„° ì¡°ê±´ë§Œ ìƒˆë¡œ ì ìš©í•˜ëŠ” ë©”ì„œë“œ**
</br>

- `lvc_s_filt` : í•„í„° ì¡°ê±´ 1ê°œ
- `lvc_t_filt` : í•„í„° ì¡°ê±´ ì—¬ëŸ¬ ê°œë¥¼ ë‹´ëŠ” í…Œì´ë¸”
- `fieldname` ëŠ” ALVì—ì„œ í•„í„°ë¥¼ ì ìš©í•  ì»¬ëŸ¼ëª…ì„ ì˜ë¯¸
- `sign` ì€ ì¡°ê±´ì„ í¬í•¨(I)í• ì§€ ì œì™¸(E)í• ì§€ë¥¼ ê²°ì •
- `option` ì€ ë¹„êµ ë°©ì‹ìœ¼ë¡œ EQ(ê°™ìŒ), BT(ë²”ìœ„), GE/LE(ì´ìƒÂ·ì´í•˜) ë“±ì„ ì§€ì •
- `low` ëŠ” ë¹„êµì— ì‚¬ìš©ë˜ëŠ” ê¸°ì¤€ ê°’ì´ë©°, BT ì‚¬ìš© ì‹œ ì‹œì‘ê°’. `high` ëŠ” BT ì˜µì…˜ ì‚¬ìš© ì‹œ ë²”ìœ„ì˜ ì¢…ë£Œê°’.
```abap
DATA: gt_filter TYPE lvc_t_filt,
      gs_filter TYPE lvc_s_filt.

gs_filter-fieldname = '<FIELD_NAME>'.
gs_filter-sign      = 'I'.
gs_filter-option    = 'EQ'.
gs_filter-low       = <VALUE>.
APPEND gs_filter TO gt_filter.
CLEAR gs_filter.

CALL METHOD <alv_ref>->set_table_for_first_display
  EXPORTING
    i_structure_name = '<DDIC>'
  CHANGING
    it_outtab = <itab>
    it_filter = gt_filter.
```
```abap
DATA: gt_filter TYPE lvc_t_filt,
      gs_filter TYPE lvc_s_filt.

" í•­ê³µì‚¬ í•„í„°
gs_filter-fieldname = 'CARRID'.
gs_filter-sign      = 'I'.
gs_filter-option    = 'EQ'.
gs_filter-low       = 'DL'.
APPEND gs_filter TO gt_filter.
CLEAR gs_filter.

" ë…¸ì„  í•„í„°
gs_filter-fieldname = 'CONNID'.
gs_filter-sign      = 'I'.
gs_filter-option    = 'EQ'.
gs_filter-low       = '1699'.
APPEND gs_filter TO gt_filter.

CALL METHOD go_alv_grid->set_table_for_first_display
  EXPORTING
    i_structure_name = 'SFLIGHT'
  CHANGING
    it_outtab = gt_flight
    it_filter = gt_filter.
```
</br>
</br>
</br>

### 6) ALV Line Color (í–‰ ìƒ‰ìƒ ì œì–´)
- ALV í–‰(Line)ì— ìƒ‰ìƒì„ ì ìš©í•˜ëŠ” ê¸°ëŠ¥
- `INFO_FNAME` : ALVì—ê²Œ â€œí–‰ ìƒ‰ìƒ(Line Color) ì •ë³´ê°€ ë“¤ì–´ìˆëŠ” í•„ë“œëª…â€ì„ ì•Œë ¤ì£¼ëŠ” ì„¤ì •
- `TYPE-POOLS COL.` ë¡œ ìƒ‰ìƒ ì½”ë“œ í™•ì¸ ê°€ëŠ¥ (í•„ìˆ˜)
```abap
TYPE-POOLS COL.
'C' && <color_constant> && <intensified> && <inverse>
```
- `C` : ìƒ‰ìƒ ì‚¬ìš© í‘œì‹œ
- `<color_constant>` : ìƒ‰ìƒ ë²ˆí˜¸ (0~7)
- `<intensified>` : ì§„í•˜ê²Œ í‘œì‹œ (1) / ê¸°ë³¸ (0)
- `<inverse>` : ê¸€ììƒ‰ â†” ë°°ê²½ìƒ‰ ë°˜ì „ (1) / ê¸°ë³¸ (0)
```abap
TYPE-POOLS col.

TYPES: BEGIN OF gty_booking,
         INCLUDE TYPE sbook,
         color TYPE c LENGTH 4,
       END OF gty_booking.

DATA: gs_booking TYPE gty_booking,
      gt_booking TYPE TABLE OF gty_booking,
      gs_layout  TYPE lvc_s_layo.

gs_booking-color = 'C' && col_negative && '10'.
gs_layout-info_fname = 'COLOR'.

CALL METHOD go_alv_grid->set_table_for_first_display
  EXPORTING
    is_layout = gs_layout
  CHANGING
    it_outtab = gt_booking.
```
</br>
</br>
</br>

### 7) ALV Cell Color (ì…€ ë‹¨ìœ„ ìƒ‰ìƒ ì œì–´)
- ALVì—ì„œ íŠ¹ì • ì…€ë§Œ ìƒ‰ìƒ ë³€ê²½í•˜ëŠ” ê¸°ëŠ¥
- í–‰ ìƒ‰ìƒê³¼ ë‹¬ë¦¬ ì…€ ìƒ‰ìƒìš© ë‚´ë¶€í…Œì´ë¸” ì‚¬ìš©
- ê° í–‰ë§ˆë‹¤ `lvc_t_scol` íƒ€ì… ë‚´ë¶€í…Œì´ë¸”ì„ ê°€ì§
- ìƒ‰ìƒ ì ìš© í›„ `CTAB_FNAME` ìœ¼ë¡œ ALVì— ì „ë‹¬í•´ì•¼ í‘œì‹œë¨
- `CTAB_FNAME` : ALVì—ê²Œ â€œì…€ ìƒ‰ìƒ(Cell Color) ì •ë³´ê°€ ë“¤ì–´ìˆëŠ” í•„ë“œëª…â€ì„ ì•Œë ¤ì£¼ëŠ” ì„¤ì •
</br>

- `lt_scol` : ì´ í–‰ì—ì„œ ìƒ‰ì¹ í•  ì…€ ëª©ë¡ (`lvc_t_scol`)
- `ls_scol` : ì…€ í•˜ë‚˜ ìƒ‰ìƒ ì •ë³´ (`lvc_s_scol`)
- `<ls_scol>-fname` : ìƒ‰ìƒì„ ì ìš©í•  ì»¬ëŸ¼(í•„ë“œ) ì´ë¦„ì„ ì§€ì •í•¨.
- `<ls_scol>-color-col` : í•´ë‹¹ ì…€ì— ì ìš©í•  ìƒ‰ìƒì„ ì§€ì •í•¨.
- `<ls_scol>-color-int` : ìƒ‰ìƒì„ ì§„í•˜ê²Œ í‘œì‹œí• ì§€ ì—¬ë¶€ë¥¼ ì§€ì •í•¨.
- `<ls_scol>-color-inv` : ê¸€ììƒ‰ê³¼ ë°°ê²½ìƒ‰ì„ ì„œë¡œ ë°”ê¿€ì§€ ì—¬ë¶€ë¥¼ ì§€ì •í•¨.
```abap
LVC_S_SCOL
 â”œâ”€ FNAME        "ìƒ‰ì¹ í•  ì»¬ëŸ¼ëª…
 â””â”€ COLOR        "ìƒ‰ìƒ ì •ë³´ êµ¬ì¡°ì²´
     â”œâ”€ COL
     â”œâ”€ INT
     â””â”€ INV
```
```abap
" 1. ì¶œë ¥ êµ¬ì¡°
DATA: BEGIN OF <gs_data>.
        INCLUDE TYPE <structure>.
DATA: <excp_fld> TYPE char1,
      <col_fld>  TYPE char4,        " Line Color
      <lt_scol>  TYPE lvc_t_scol,   " Cell Color
     END OF <gs_data>.

DATA <gt_data> LIKE TABLE OF <gs_data>.
DATA <ls_scol> TYPE lvc_s_scol.


" 2. ì…€ ìƒ‰ìƒ ì²˜ë¦¬
LOOP AT <gt_data> INTO <gs_data>.
  IF <ì¡°ê±´>.
    <ls_scol>-fname      = '<FIELDNAME>'.
    <ls_scol>-color-col  = <COLOR>.
    <ls_scol>-color-int  = '1'.
    <ls_scol>-color-inv  = '0'.

    APPEND <ls_scol> TO <gs_data>-<lt_scol>.
  ENDIF.

  MODIFY <gt_data> FROM <gs_data>
    TRANSPORTING <lt_scol>.
ENDLOOP.


" 3. Layout ì—°ê²°
gs_layout-ctab_fname = '<lt_scol í•„ë“œëª…>'.

" 4. ALV ì¶œë ¥
CALL METHOD go_alv_grid->set_table_for_first_display
  EXPORTING
    is_layout = gs_layout
  CHANGING
    it_outtab = <gt_data>.
```
```abap
" 1. ì¶œë ¥ êµ¬ì¡°
DATA: BEGIN OF gs_data.
        INCLUDE TYPE sbook.
DATA: excp_fld TYPE char1,
      col_fld  TYPE char4,        " ì˜ˆ: 'C310'
      lt_scol  TYPE lvc_t_scol,   " ì…€ ìƒ‰ìƒ
     END OF gs_data.

DATA gt_data LIKE TABLE OF gs_data.
DATA ls_scol TYPE lvc_s_scol.


" 2. ì…€ ìƒ‰ìƒ ì²˜ë¦¬
LOOP AT gt_data INTO gs_data.

  IF gs_data-loccuram < 500.
    gs_data-excp_fld = '1'.
  ELSEIF gs_data-loccuram >= 500 AND gs_data-loccuram <= 800.
    gs_data-excp_fld = '2'.
  ELSE.
    gs_data-excp_fld = '3'.
  ENDIF.

  IF gs_data-smoker = 'X'.

*   Line Color
    gs_data-col_fld = 'C' && col_negative && '10'.

*   Cell Color (SMOKER ì…€ë§Œ)
    ls_scol-fname      = 'SMOKER'.
    ls_scol-color-col  = col_negative.
    ls_scol-color-int  = '1'.
    ls_scol-color-inv  = '0'.

    APPEND ls_scol TO gs_data-lt_scol.
  ENDIF.

  MODIFY gt_data FROM gs_data
    TRANSPORTING excp_fld col_fld lt_scol.

  CLEAR gs_data.
ENDLOOP.


" 3. Layout ì—°ê²°
gs_layout-ctab_fname = 'LT_SCOL'.

" 4. ALV ì¶œë ¥
CALL METHOD go_alv_grid->set_table_for_first_display
  EXPORTING
    is_layout = gs_layout
  CHANGING
    it_outtab = gt_data.
```
</br>
</br>

---

</br>

## < ABAP ê°ì²´ ìƒì„± ê¸°ë³¸ ë¬¸ë²• ì˜ˆì œ >
</br>

**1) `TOP` ëª¨ë“ˆ ìˆ˜ì •**
- `SY-REPID` : í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ ABAP í”„ë¡œê·¸ë¨ëª…(Report ID)
```abap
TYPE-POOLS COL.

TABLES: SDYN_CONN.

DATA: BEGIN OF gs_data.
        INCLUDE TYPE sbook.
DATA: excp_fld TYPE char1,
      col_fld TYPE char4, "ì˜ˆì‹œ)'C310'
      lt_scol TYPE LVC_T_SCOL,
     END OF gs_data.
DATA gt_data LIKE TABLE OF gs_data.
DATA ls_scol TYPE LVC_S_SCOL.

DATA: ok_code TYPE sy-ucomm,
      go_cont TYPE REF TO cl_gui_custom_container,
      go_alv  TYPE REF TO cl_gui_alv_grid.
DATA: gs_variant TYPE disvariant,
      gs_stable TYPE LVC_S_STBL,
      gs_layout TYPE LVC_S_LAYO, " ë ˆì´ì•„ì›ƒ
      gt_sorter TYPE LVC_T_SORT, " ì •ë ¬(itab)
      gs_sorter TYPE LVC_S_SORT, " ì •ë ¬(str)
      gt_filter TYPE LVC_T_FILT, " í•„í„°(itab)
      gs_filter TYPE LVC_S_FILT. " í•„í„°(str)

SELECTION-SCREEN BEGIN OF BLOCK blk1 WITH FRAME.
  SELECT-OPTIONS: so_car FOR gs_data-carrid,
                  so_con FOR gs_data-connid,
                  so_fdt FOR gs_data-fldate.
SELECTION-SCREEN END OF BLOCK blk1.

SELECTION-SCREEN BEGIN OF SCREEN 1100 AS SUBSCREEN.
  SELECT-OPTIONS: so_car2 FOR SDYN_CONN-CARRID DEFAULT 'DL',
                  so_con2 FOR SDYN_CONN-CONNID.
SELECTION-SCREEN END OF SCREEN 1100.

INITIALIZATION.
  PERFORM set_options.
  gs_variant-report = sy-repid.
  gs_variant-username = sy-uname.
  gs_variant-handle = 'MAIN'.
  " handle : í•˜ë‚˜ì˜ í™”ë©´ì— ì—¬ëŸ¬ê°œì˜ ALVê°€ ìˆëŠ” ê²½ìš°
  "          ê° ALVë§ˆë‹¤ êµ¬ë¶„ìê°€ í•„ìš”í•˜ë¯€ë¡œ êµ¬ë¶„ì ì§€ì •í•´ì¤Œ

START-OF-SELECTION.
  PERFORM GET_DATA.
  CALL SCREEN 100.
```
</br>
</br>

**2) `F01` ëª¨ë“ˆ ìˆ˜ì •**
```abap
FORM set_options.
  so_fdt-sign = 'I'.
  so_fdt-option = 'BT'.
  so_fdt-low = sy-datum(4) && '0101'. " ë§¤ë…„ ì²«ì§¸ë‚ 
  so_fdt-high = sy-datum(4) && '1231'. " ë§¤ë…„ ë§ˆì§€ë§‰ë‚ 
  APPEND so_fdt.

  so_car-sign = 'I'.
  so_car-option = 'GT'.
  so_car-low = 'AZ'.
  APPEND so_car.

  CLEAR so_car.
  so_car-sign = 'E'.
  so_car-option = 'EQ'.
  so_car-low = 'LH'.
  APPEND so_car.
ENDFORM.

*&---------------------------------------------------------------------*

FORM get_data.
  SELECT * FROM SBOOK
    INTO CORRESPONDING FIELDS OF TABLE gt_data
    WHERE carrid IN so_car
      AND connid IN so_con
      AND fldate IN so_fdt.
  IF sy-subrc <> 0.
    MESSAGE 'ë°ì´í„°ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.' TYPE 'E'.
  ELSE.
    LOOP AT gt_data INTO gs_data.
      IF gs_data-loccuram < 500.
        gs_data-EXCP_FLD = '1'. " ë¹¨ê°•
      ELSEIF gs_data-loccuram >= 500 AND gs_data-loccuram <= 800.
        gs_data-EXCP_FLD = '2'. " ë…¸ë‘
      ELSE.
        gs_data-EXCP_FLD = '3'. " ì´ˆë¡
      ENDIF.

      IF gs_data-smoker = 'X'.
        gs_data-col_fld = 'C' && col_negative && '10'.

*        smoker í•„ë“œì— ëŒ€í•´ ìƒ‰ìƒ ì •ë¦¬
        ls_scol-fname = 'SMOKER'.
        ls_scol-color-col = '3'.
        ls_scol-color-int = '1'.
        ls_scol-color-inv = '0'.

        APPEND ls_scol TO gs_data-lt_scol.
      ENDIF.

      MODIFY gt_data FROM gs_data TRANSPORTING EXCP_FLD col_fld lt_scol.
      CLEAR gs_data.
    ENDLOOP.
  ENDIF.
ENDFORM.

*&---------------------------------------------------------------------*

FORM set_layout.
  gs_layout-grid_title = 'Booking List'. " Title ì ìš©
  gs_layout-zebra = 'X'.  " Row êµ¬ë¶„ìƒ‰ ì ìš©
  gs_layout-cwidth_opt = 'X'. " ì»¬ëŸ¼ë„ˆë¹„ ìµœì í™”
  gs_layout-totals_bef = 'X'. " í•©ê³„ ë§¨ ìœ„ë¡œ
  gs_layout-sel_mode = 'A'. " _,A,B,C,D ì„ íƒëª¨ë“œ

  gs_layout-excp_fname = 'EXCP_FLD'. " ë³€ìˆ˜ëª… ì•Œë ¤ì¤Œ
  gs_layout-excp_led = 'X'.
  gs_layout-info_fname = 'COL_FLD'. " ë³€ìˆ˜ëª… ì•Œë ¤ì¤Œ
  gs_layout-ctab_fname = 'LT_SCOL'. " ë³€ìˆ˜ëª… ì•Œë ¤ì¤Œ
ENDFORM.

*&---------------------------------------------------------------------*

FORM set_sorter.
  IF gt_sorter IS INITIAL.
    gs_sorter-fieldname = 'ORDER_DATE'.
    gs_sorter-spos = 1.
    gs_sorter-up = 'X'. " ì˜¤ë¦„ì°¨ìˆœ (ê¸°ë³¸)
    APPEND gs_sorter TO gt_sorter. " itab ë§¨ ë§ˆì§€ë§‰ì— ì¶”ê°€

    CLEAR gs_sorter.
    gs_sorter-fieldname = 'LOCCURAM'.
    gs_sorter-spos = 2.
    gs_sorter-down = 'X'. " ë‚´ë¦¼ì°¨ìˆœ
    APPEND gs_sorter TO gt_sorter.
  ENDIF.
ENDFORM.

*&---------------------------------------------------------------------*

FORM set_filter.
  CLEAR: gt_filter, gs_filter.

  IF so_car2 IS NOT INITIAL.
    LOOP AT so_car2.
      gs_filter-fieldname = 'CARRID'.
      gs_filter-sign = so_car2-sign.
      gs_filter-option = so_car2-option.
      gs_filter-low = so_car2-low.
      gs_filter-high = so_car2-high.
      APPEND gs_filter TO gt_filter.
    ENDLOOP.
  ENDIF.

  IF so_con2 IS NOT INITIAL.
    CLEAR gs_filter.
    LOOP AT so_con2.
      gs_filter-fieldname = 'CONNID'.
      gs_filter-sign = so_con2-sign.
      gs_filter-option = so_con2-option.
      gs_filter-low = so_con2-low.
      gs_filter-high = so_con2-high.
      APPEND gs_filter TO gt_filter.
    ENDLOOP.
  ENDIF.

  " ë§Œì•½ sorterë„ í™”ë©´ ì¶œë ¥ ì´í›„ì— ë³€ê²½í•˜ê³ ì í•œë‹¤ë©´,
  " => set_sorter_criteria ì‚¬ìš©
  CALL METHOD go_alv->set_filter_criteria
    EXPORTING
      it_filter = gt_filter
    EXCEPTIONS
      no_fieldcatalog_available = 1
      OTHERS                    = 2.
  IF sy-subrc <> 0.
    MESSAGE 'Filter ì ìš© ì¤‘ ì—ëŸ¬ ë°œìƒ' TYPE 'E'.
  ENDIF.
ENDFORM.
```
</br>
</br>

**3) `PBO` ëª¨ë“ˆ ìˆ˜ì •**
- ALV í™”ë©´ì„ ìƒˆë¡œ ê³ ì¹¨í•˜ëŠ” ë©”ì„œë“œ í˜¸ì¶œ
  
<img width="289" height="278" alt="image" src="https://github.com/user-attachments/assets/897d99d2-81ef-4170-8df4-279379ebac4a" />
</br>
</br>

```abap
MODULE init_alv OUTPUT.
  " 1. 100ë²ˆ ìŠ¤í¬ë¦° Layoutì— Area ì¶”ê°€
  " 2. ë§Œì•½ Container ê°€ ë§Œë“¤ì–´ì§€ê¸° ì „ì´ë¼ë©´, ê°ì²´ ìƒì„±í•¨
  "    Custom Container ìƒì„±
  IF go_cont IS INITIAL.
    CREATE OBJECT go_cont
      EXPORTING
        container_name              = 'AREA'
      EXCEPTIONS
        cntl_error                  = 1
        cntl_system_error           = 2
        create_error                = 3
        lifetime_error              = 4
        lifetime_dynpro_dynpro_link = 5
        others                      = 6.
    IF sy-subrc <> 0.
    ENDIF.

    " 3. ALV Grid ê°ì²´ ìƒì„±í•´ì„œ Containerì™€ ì—°ê²°
    CREATE OBJECT go_alv
      EXPORTING
        i_parent          = go_cont
      EXCEPTIONS
        error_cntl_create = 1
        error_cntl_init   = 2
        error_cntl_link   = 3
        error_dp_create   = 4
        others            = 5.
    IF sy-subrc <> 0.
    ENDIF.

    PERFORM set_layout.
    PERFORM set_sorter.
    " 4. ALV Grid ì•ˆì— Data display
    CALL METHOD go_alv->set_table_for_first_display
      EXPORTING
        i_structure_name              = 'SBOOK'
        is_variant                    = gs_variant
        i_save                        = 'A' "A, X, U, ''
        i_default                     = 'X'
        is_layout                     = gs_layout
      CHANGING
        it_outtab                     = gt_data
        it_sort                       = gt_sorter
*        it_filter                    = ìµœì´ˆ ì¡°íšŒì‹œ ê¸°ë³¸í•„í„° ì ìš© ê°€ëŠ¥
      EXCEPTIONS
        invalid_parameter_combination = 1
        program_error                 = 2
        too_many_lines                = 3
        others                        = 4.

    IF sy-subrc <> 0.
    ENDIF.
  ELSE.
    gs_stable-row = 'X'.
    gs_stable-col = 'X'.

    CALL METHOD go_alv->refresh_table_display
      EXPORTING
        is_stable      = gs_stable
        i_soft_refresh = ''  " X : ì •ë ¬, í•„í„°, ê·¸ì™¸ ê¸°ëŠ¥ë“¤ ìœ ì§€
                             " _ : ì „ì²´ ë¦¬í”„ë ˆì‰¬ (ê¸°ë³¸)
      EXCEPTIONS
        finished       = 1
        others         = 2.

    IF sy-subrc <> 0.
      MESSAGE 'Data refresh ì¤‘ Error ë°œìƒ' TYPE 'E'.
    ENDIF.

  ENDIF.
ENDMODULE.
```
</br>
</br>

**4) ê²°ê³¼ í™•ì¸**

<img width="536" height="370" alt="image" src="https://github.com/user-attachments/assets/e036f5f4-8676-4972-9727-f6f3954d72af" />
</br>
</br>
</br>
</br>

---

</br>

## < ì‹¤ìŠµ ì½”ë“œ >
- layout ì‹¤ìŠµ
</br>

### ì‹¤ìŠµ 1
</br>

- ë¬¸ì œ

<img width="497" height="276" alt="image" src="https://github.com/user-attachments/assets/3d4d776c-d9ab-4b3a-ae11-d5e9062edb65" />
</br>
</br>
</br>
</br>

**1) `TOP` ëª¨ë“ˆ ìˆ˜ì •**
```abap
DATA: OK_CODE TYPE sy-ucomm,
      go_container TYPE REF TO cl_gui_custom_container,
      go_alv_grid TYPE REF TO cl_gui_alv_grid.
DATA: gs_variant TYPE disvariant,
      gs_stable TYPE LVC_S_STBL,
      gs_layout TYPE LVC_S_LAYO.

DATA: BEGIN OF gs_flight.
        INCLUDE TYPE sflight.
DATA: excp TYPE CHAR1,
      END OF gs_flight.
DATA: gt_flight LIKE TABLE OF gs_flight.

PARAMETERS: pa_va TYPE disvariant-variant.

SELECT-OPTIONS: so_car FOR gs_flight-carrid,
                so_con FOR gs_flight-connid.

START-OF-SELECTION.
  PERFORM get_data.
```
</br>
</br>

**2) `F01` ëª¨ë“ˆ ìˆ˜ì •**
```abap
FORM get_data.
  SELECT * FROM sflight
    INTO TABLE gt_flight
    WHERE carrid IN so_car
      AND connid IN so_con.
  IF sy-subrc <> 0.
    MESSAGE 'ë°ì´í„°ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.' TYPE 'E'.
  ELSE.
    LOOP AT gt_flight INTO gs_flight.
      IF gs_flight-seatsocc < 50.
        gs_flight-excp = '1'.
      ELSEIF gs_flight-seatsocc >= 50 AND gs_flight-seatsocc <= 200.
        gs_flight-excp = '2'.
      ELSE.
        gs_flight-excp = '3'.
      ENDIF.

      MODIFY gt_flight FROM gs_flight TRANSPORTING excp.
      CLEAR gs_flight.
    ENDLOOP.
  ENDIF.
ENDFORM.

*&---------------------------------------------------------------------*

FORM free_alv .
  IF go_container IS INITIAL.
    go_container->free( ).
  ENDIF.
  IF go_alv_grid IS INITIAL.
    go_alv_grid->free( ).
  ENDIF.
  FREE: go_container, go_alv_grid.
ENDFORM.

*&---------------------------------------------------------------------*

FORM set_layout.
  gs_layout-grid_title = 'Flight List'.
  gs_layout-zebra = 'X'.
  gs_layout-sel_mode = 'C'.
  gs_layout-excp_fname = 'EXCP'.
ENDFORM.
```
</br>
</br>

**3) `PBO` ëª¨ë“ˆ ìˆ˜ì •**
```abap
MODULE status_0100 OUTPUT.
 SET PF-STATUS 'S100'.
 SET TITLEBAR 'T100'.
ENDMODULE.

*&---------------------------------------------------------------------*

MODULE create_and_transfer OUTPUT.
  IF go_container IS INITIAL.
    CREATE OBJECT go_container
      EXPORTING
        container_name              = 'MY_CONTROL_AREA'
      EXCEPTIONS
        cntl_error                  = 1
        cntl_system_error           = 2
        create_error                = 3
        lifetime_error              = 4
        lifetime_dynpro_dynpro_link = 5
        others                      = 6.
    IF sy-subrc <> 0.
      MESSAGE A010(BC405_408).
    ENDIF.

    CREATE OBJECT go_alv_grid
      EXPORTING
        i_parent          = go_container
      EXCEPTIONS
        error_cntl_create = 1
        error_cntl_init   = 2
        error_cntl_link   = 3
        error_dp_create   = 4
        others            = 5.
    IF sy-subrc <> 0.
      MESSAGE A010(BC405_408).
    ENDIF.

    gs_variant-report = sy-cprog.
    gs_variant-variant = pa_va.

    PERFORM set_layout.
    CALL METHOD go_alv_grid->set_table_for_first_display
      EXPORTING
        i_structure_name              = 'sflight'
        is_variant                    = gs_variant
        i_save                        = 'A'
        is_layout                     = gs_layout
      CHANGING
        it_outtab                     = gt_flight
      EXCEPTIONS
        invalid_parameter_combination = 1
        program_error                 = 2
        too_many_lines                = 3
        others                        = 4.
    IF sy-subrc <> 0.
      MESSAGE A012(BC405_408).
    ENDIF.


  ENDIF.
ENDMODULE.

*&---------------------------------------------------------------------*

MODULE clear_ok_code OUTPUT.
  CLEAR OK_CODE.
ENDMODULE.
```
</br>
</br>

**4) ê²°ê³¼ í™•ì¸**

<img width="499" height="384" alt="image" src="https://github.com/user-attachments/assets/ac3e549d-a76c-48cd-b8b3-da963ca38b9a" />
</br>
</br>
</br>
</br>
</br>
</br>

### ì‹¤ìŠµ 2
- filter ì‹¤ìŠµ
- ë”°ë¡œ ì„œë¸ŒìŠ¤í¬ë¦° ìƒì„±í•˜ì§€ ì•Šê¸° (ìë™ìœ¼ë¡œ ìƒì„±ë¨)

</br>

- ë¬¸ì œ
<img width="451" height="245" alt="image" src="https://github.com/user-attachments/assets/c2d9d3f8-f159-40dc-bb07-6071b387e9b9" />
</br>
</br>
</br>
</br>

**1) `Screen 100` ìˆ˜ì •**
```abap
PROCESS BEFORE OUTPUT.
  MODULE status_0100.
  CALL SUBSCREEN SUB01 INCLUDING sy-cprog '1100'.
  MODULE init_alv.
*
PROCESS AFTER INPUT.
  MODULE exit AT EXIT-COMMAND.
  CALL SUBSCREEN SUB01.
  MODULE user_command_0100.
```
</br>
</br>

**2) `TOP` ëª¨ë“ˆ ìˆ˜ì •**
```abap
TABLES: SDYN_CONN.

*DATA: gt_data TYPE TABLE OF sbook,
*      gs_data LIKE LINE OF gt_data.
DATA: BEGIN OF gs_data.
        INCLUDE TYPE sbook.
DATA: excp_fld TYPE CHAR1,
      END OF gs_data.
DATA: gt_data LIKE TABLE OF gs_data.

DATA: ok_code TYPE sy-ucomm,
      go_cont TYPE REF TO cl_gui_custom_container,
      go_alv  TYPE REF TO cl_gui_alv_grid.
DATA: gs_variant TYPE disvariant,
      gs_stable TYPE LVC_S_STBL,
      gs_layout TYPE LVC_S_LAYO, " ë ˆì´ì•„ì›ƒ
      gt_sorter TYPE LVC_T_SORT, " ì •ë ¬(itab)
      gs_sorter TYPE LVC_S_SORT, " ì •ë ¬(str)
      gt_filter TYPE LVC_T_FILT, " í•„í„°(itab)
      gs_filter TYPE LVC_S_FILT. " í•„í„°(str)

SELECTION-SCREEN BEGIN OF BLOCK blk1 WITH FRAME.
  SELECT-OPTIONS: so_car FOR gs_data-carrid,
                  so_con FOR gs_data-connid,
                  so_fdt FOR gs_data-fldate.
SELECTION-SCREEN END OF BLOCK blk1.

SELECTION-SCREEN BEGIN OF SCREEN 1100 AS SUBSCREEN.
  SELECT-OPTIONS: so_car2 FOR SDYN_CONN-CARRID DEFAULT 'DL',
                  so_con2 FOR SDYN_CONN-CONNID.
SELECTION-SCREEN END OF SCREEN 1100.

INITIALIZATION.
  PERFORM set_options.
  gs_variant-report = sy-cprog.
  gs_variant-username = sy-uname.
  gs_variant-handle = 'MAIN'.
  " handle : í•˜ë‚˜ì˜ í™”ë©´ì— ì—¬ëŸ¬ê°œì˜ ALVê°€ ìˆëŠ” ê²½ìš°
  "          ê° ALVë§ˆë‹¤ êµ¬ë¶„ìê°€ í•„ìš”í•˜ë¯€ë¡œ êµ¬ë¶„ì ì§€ì •í•´ì¤Œ

START-OF-SELECTION.
  PERFORM GET_DATA.
  CALL SCREEN 100.
```
</br>
</br>

**3) `F01` ëª¨ë“ˆ ìˆ˜ì •**
```abap
FORM set_options.
  so_fdt-sign = 'I'.
  so_fdt-option = 'BT'.
  so_fdt-low = sy-datum(4) && '0101'. " ë§¤ë…„ ì²«ì§¸ë‚ 
  so_fdt-high = sy-datum(4) && '1231'. " ë§¤ë…„ ë§ˆì§€ë§‰ë‚ 
  APPEND so_fdt.

  so_car-sign = 'I'.
  so_car-option = 'GT'.
  so_car-low = 'AZ'.
  APPEND so_car.

  CLEAR so_car.
  so_car-sign = 'E'.
  so_car-option = 'EQ'.
  so_car-low = 'LH'.
  APPEND so_car.
ENDFORM.

*&---------------------------------------------------------------------*

FORM get_data.
  SELECT * FROM SBOOK
    INTO CORRESPONDING FIELDS OF TABLE gt_data
    WHERE carrid IN so_car
      AND connid IN so_con
      AND fldate IN so_fdt.
  IF sy-subrc <> 0.
    MESSAGE 'ë°ì´í„°ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.' TYPE 'E'.
  ELSE.
    LOOP AT gt_data INTO gs_data.
      IF gs_data-loccuram < 500.
        gs_data-EXCP_FLD = '1'. " ë¹¨ê°•
      ELSEIF gs_data-loccuram >= 500 AND gs_data-loccuram <= 800.
        gs_data-EXCP_FLD = '2'. " ë…¸ë‘
      ELSE.
        gs_data-EXCP_FLD = '3'. " ì´ˆë¡
      ENDIF.

      MODIFY gt_data FROM gs_data TRANSPORTING EXCP_FLD.
      CLEAR gs_data.
    ENDLOOP.
  ENDIF.
ENDFORM.

*&---------------------------------------------------------------------*

FORM set_layout.
  gs_layout-grid_title = 'Booking List'. " Title ì ìš©
  gs_layout-zebra = 'X'.  " Row êµ¬ë¶„ìƒ‰ ì ìš©
  gs_layout-cwidth_opt = 'X'. " ì»¬ëŸ¼ë„ˆë¹„ ìµœì í™”
  gs_layout-totals_bef = 'X'. " í•©ê³„ ë§¨ ìœ„ë¡œ
  gs_layout-sel_mode = 'A'. " _,A,B,C,D ì„ íƒëª¨ë“œ

  gs_layout-excp_fname = 'EXCP_FLD'. " ë³€ìˆ˜ëª… ì•Œë ¤ì¤Œ
  gs_layout-excp_led = 'X'.
ENDFORM.

*&---------------------------------------------------------------------*

FORM set_sorter .
  IF gt_sorter IS INITIAL.
    gs_sorter-fieldname = 'ORDER_DATE'.
    gs_sorter-spos = 1.
    gs_sorter-up = 'X'. " ì˜¤ë¦„ì°¨ìˆœ (ê¸°ë³¸)
    APPEND gs_sorter TO gt_sorter. " itab ë§¨ ë§ˆì§€ë§‰ì— ì¶”ê°€

    CLEAR gs_sorter.
    gs_sorter-fieldname = 'LOCCURAM'.
    gs_sorter-spos = 2.
    gs_sorter-down = 'X'. " ë‚´ë¦¼ì°¨ìˆœ
    APPEND gs_sorter TO gt_sorter.
  ENDIF.
ENDFORM.

*&---------------------------------------------------------------------*

FORM set_filter.
  CLEAR: gt_filter, gs_filter.

  IF so_car2 IS NOT INITIAL.
    LOOP AT so_car2.
      gs_filter-fieldname = 'CARRID'.
      gs_filter-sign = so_car2-sign.
      gs_filter-option = so_car2-option.
      gs_filter-low = so_car2-low.
      gs_filter-high = so_car2-high.
      APPEND gs_filter TO gt_filter.
    ENDLOOP.
  ENDIF.

  IF so_con2 IS NOT INITIAL.
    CLEAR gs_filter.
    LOOP AT so_con2.
      gs_filter-fieldname = 'CONNID'.
      gs_filter-sign = so_con2-sign.
      gs_filter-option = so_con2-option.
      gs_filter-low = so_con2-low.
      gs_filter-high = so_con2-high.
      APPEND gs_filter TO gt_filter.
    ENDLOOP.
  ENDIF.

  " ë§Œì•½ sorterë„ í™”ë©´ ì¶œë ¥ ì´í›„ì— ë³€ê²½í•˜ê³ ì í•œë‹¤ë©´,
  " => set_sorter_criteria ì‚¬ìš©
  CALL METHOD go_alv->set_filter_criteria
    EXPORTING
      it_filter = gt_filter
    EXCEPTIONS
      no_fieldcatalog_available = 1
      OTHERS                    = 2.
  IF sy-subrc <> 0.
    MESSAGE 'Filter ì ìš© ì¤‘ ì—ëŸ¬ ë°œìƒ' TYPE 'E'.
  ENDIF.
ENDFORM.
```
</br>
</br>

**4) `PBO` ëª¨ë“ˆ ìˆ˜ì •**
```abap
MODULE status_0100 OUTPUT.
 SET PF-STATUS 'S100'.
 SET TITLEBAR 'T100' WITH sy-uname sy-datum sy-uzeit.
ENDMODULE.

*&---------------------------------------------------------------------*

MODULE init_alv OUTPUT.
  " 1. 100ë²ˆ ìŠ¤í¬ë¦° Layoutì— Area ì¶”ê°€
  " 2. ë§Œì•½ Container ê°€ ë§Œë“¤ì–´ì§€ê¸° ì „ì´ë¼ë©´, ê°ì²´ ìƒì„±í•¨
  "    Custom Container ìƒì„±
  IF go_cont IS INITIAL.
    CREATE OBJECT go_cont
      EXPORTING
        container_name              = 'AREA'
      EXCEPTIONS
        cntl_error                  = 1
        cntl_system_error           = 2
        create_error                = 3
        lifetime_error              = 4
        lifetime_dynpro_dynpro_link = 5
        others                      = 6.
    IF sy-subrc <> 0.
*     MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*                WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
    ENDIF.

    " 3. ALV Grid ê°ì²´ ìƒì„±í•´ì„œ Containerì™€ ì—°ê²°
    CREATE OBJECT go_alv
      EXPORTING
        i_parent          = go_cont
      EXCEPTIONS
        error_cntl_create = 1
        error_cntl_init   = 2
        error_cntl_link   = 3
        error_dp_create   = 4
        others            = 5.
    IF sy-subrc <> 0.
*     MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*                WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
    ENDIF.

    PERFORM set_layout.
    PERFORM set_sorter.
    " 4. ALV Grid ì•ˆì— Data display
    CALL METHOD go_alv->set_table_for_first_display
      EXPORTING
*        i_buffer_active               =
*        i_bypassing_buffer            =
*        i_consistency_check           =
        i_structure_name              = 'SBOOK'
        is_variant                    = gs_variant
        i_save                        = 'A' "A, X, U, ''
        i_default                     = 'X'
        is_layout                     = gs_layout
*        is_print                      =
*        it_special_groups             =
*        it_toolbar_excluding          =
*        it_hyperlink                  =
*        it_alv_graphics               =
*        it_except_qinfo               =
*        ir_salv_adapter               =
      CHANGING
        it_outtab                     = gt_data
        it_sort                       = gt_sorter
*        it_filter                    = ìµœì´ˆ ì¡°íšŒì‹œ ê¸°ë³¸í•„í„° ì ìš© ê°€ëŠ¥
      EXCEPTIONS
        invalid_parameter_combination = 1
        program_error                 = 2
        too_many_lines                = 3
        others                        = 4.

    IF sy-subrc <> 0.
*     Implement suitable error handling here
    ENDIF.
  ELSE.
    gs_stable-row = 'X'.
    gs_stable-col = 'X'.

    CALL METHOD go_alv->refresh_table_display
      EXPORTING
        is_stable      = gs_stable
        i_soft_refresh = ''  " X : ì •ë ¬, í•„í„°, ê·¸ì™¸ ê¸°ëŠ¥ë“¤ ìœ ì§€
                             " _ : ì „ì²´ ë¦¬í”„ë ˆì‰¬ (ê¸°ë³¸)
      EXCEPTIONS
        finished       = 1
        others         = 2.

    IF sy-subrc <> 0.
      MESSAGE 'Data refresh ì¤‘ Error ë°œìƒ' TYPE 'E'.
    ENDIF.

  ENDIF.
ENDMODULE.
```
</br>
</br>

**5) `PAI` ëª¨ë“ˆ ìˆ˜ì •**
```abap
MODULE exit INPUT.
  CASE OK_CODE.
    WHEN 'EXIT'.
      LEAVE PROGRAM.
    WHEN 'CANCEL'.
      LEAVE TO SCREEN 0.
    WHEN OTHERS.
  ENDCASE.
ENDMODULE.

*----------------------------------------------------------------------*

MODULE user_command_0100 INPUT.
  CASE OK_CODE.
    WHEN 'BACK'.
      LEAVE TO SCREEN 0.
    WHEN 'SEARCH'.
      PERFORM set_filter.
    WHEN OTHERS.
  ENDCASE.
ENDMODULE.
```
</br>
</br>

**6) ê²°ê³¼ í™•ì¸**

<img width="505" height="273" alt="image" src="https://github.com/user-attachments/assets/d069801f-404f-44e3-b297-150e8e0de9af" />

</br>
</br>
</br>
</br>
</br>
</br>

### ì‹¤ìŠµ 3
</br>

- ë¬¸ì œ

<img width="474" height="283" alt="image" src="https://github.com/user-attachments/assets/c6b45c6d-2851-41f2-97a9-1a145c147234" />

</br>
</br>
</br>
</br>

**1) `TOP` ëª¨ë“ˆ ìˆ˜ì •**
```abap
DATA: gs_variant TYPE disvariant,
      gs_stable TYPE LVC_S_STBL,
      gs_layout TYPE LVC_S_LAYO.

DATA: BEGIN OF gs_flight.
        INCLUDE TYPE sflight.
DATA: excp TYPE CHAR1,
      color TYPE C LENGTH 4,
      lt_col TYPE LVC_T_SCOL,
      END OF gs_flight.
DATA: gt_flight LIKE TABLE OF gs_flight.
DATA: ls_col TYPE LVC_S_SCOL.
```
</br>
</br>

**2) `F01` ëª¨ë“ˆ ìˆ˜ì •**
```abap
FORM get_data.
  SELECT * FROM sflight
    INTO CORRESPONDING FIELDS OF TABLE gt_flight
    WHERE carrid IN so_car
      AND connid IN so_con.
  IF sy-subrc <> 0.
    MESSAGE 'ë°ì´í„°ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.' TYPE 'E'.
  ELSE.
    LOOP AT gt_flight INTO gs_flight.
      IF gs_flight-seatsocc < 50.
        gs_flight-excp = '1'.
      ELSEIF gs_flight-seatsocc >= 50 AND gs_flight-seatsocc <= 200.
        gs_flight-excp = '2'.
      ELSE.
        gs_flight-excp = '3'.
      ENDIF.

      IF gs_flight-fldate+0(4) = sy-datum+0(4).
        gs_flight-color = 'C' && col_positive && 10.
      ENDIF.

      IF gs_flight-seatsmax - gs_flight-seatsocc  < 10.
        ls_col-fname = 'SEATSMAX'.
        ls_col-color-col = '6'.
        ls_col-color-int = '0'.
        ls_col-color-inv = '1'.
        APPEND ls_col TO gs_flight-lt_col.
        CLEAR ls_col.

        ls_col-fname = 'SEATSOCC'.
        ls_col-color-col = '6'.
        ls_col-color-int = '0'.
        ls_col-color-inv = '1'.

        APPEND ls_col TO gs_flight-lt_col.
      ENDIF.

      MODIFY gt_flight FROM gs_flight TRANSPORTING excp color lt_col.
      CLEAR gs_flight.
    ENDLOOP.
  ENDIF.
ENDFORM.

*&---------------------------------------------------------------------*

FORM set_layout .
  gs_layout-grid_title = 'Flight List'.
  gs_layout-zebra = 'X'.
  gs_layout-sel_mode = 'C'.
  gs_layout-excp_fname = 'EXCP'.
  gs_layout-info_fname = 'COLOR'.
  gs_layout-ctab_fname = 'LT_COL'.
ENDFORM.
```
</br>
</br>

**3) `PBO` ëª¨ë“ˆ**
```abap
PERFORM set_layout.
    CALL METHOD go_alv_grid->set_table_for_first_display
      EXPORTING
        i_structure_name              = 'sflight'
        is_variant                    = gs_variant
        i_save                        = 'A'
        is_layout                     = gs_layout
      CHANGING
        it_outtab                     = gt_flight
      EXCEPTIONS
        invalid_parameter_combination = 1
        program_error                 = 2
        too_many_lines                = 3
        others                        = 4.
    IF sy-subrc <> 0.
      MESSAGE A012(BC405_408).
    ENDIF.
```
</br>
</br>

**4) ê²°ê³¼ í™•ì¸**

<img width="399" height="308" alt="image" src="https://github.com/user-attachments/assets/fd86219f-6de5-48d8-8e4b-006378b0b7a9" />
