## <  핵심 개념 >
</br>

- **1) Pushbutton**
- **2) Selection Screen 필드 제어**
</br>

- 그룹명 같은 **이름** 지정 시 무조건 **대문자**
</br>
</br>

---

</br>

## < Selection Screen >
</br>

### 1) Pushbutton
- Selection Screen 에 버튼을 하나 추가
- 버튼 클릭 시 USER-COMMAND(OKCODE) 발생
- 버튼 생성 안되면 `/` 또는 `SKIP` 으로 띄우고 생성하기
```abap
TABLES <screen_fields>.

SELECTION-SCREEN
  PUSHBUTTON <position>(<length>) <text_var>
  USER-COMMAND <okcode>.
```
```abap
INITIALIZATION.
  <text_var> = '<버튼 텍스트>'.

AT SELECTION-SCREEN.
  CASE <screen_fields>-ucomm.
    WHEN '<okcode>'.
      " 버튼 클릭 시 처리 로직
  ENDCASE.
```
- 예시 코드
```abap
*************** TOP ****************
TABLES SSCRFIELDS.

DATA gv_btn_text TYPE string.

PARAMETERS p_carr TYPE scarr-carrid.

SELECTION-SCREEN
  PUSHBUTTON /10(20) gv_btn_text USER-COMMAND btn.    " / 은 줄 바꿈

*************** E01 ****************
INITIALIZATION.
  gv_btn_text = 'Display details'.

AT SELECTION-SCREEN.
  CASE SSCRFIELDS-ucomm.
    WHEN 'BTN'.
      MESSAGE 'Pushbutton 클릭됨' TYPE 'I'.
  ENDCASE.
```

</br>
</br>

### 2) Selection Screen 필드 제어
- Selection Screen에서 필드의 표시/입력 여부를 화면 출력 직전에 제어
- **CS (Contain String)** : 왼쪽 문자열 안에 오른쪽 문자열이 포함되면 TRUE
```abap
AT SELECTION-SCREEN OUTPUT.

  LOOP AT SCREEN.
    IF <조건>.
      screen-<속성> = <값>.
      MODIFY SCREEN.
    ENDIF.
  ENDLOOP.
```
- `screen-active` → 0이면 필드 완전 숨김, 1이면 표시
- `screen-invisible` → 1이면 값이 *****로 마스킹되어 보임
- `screen-input` → 0이면 입력 불가(읽기 전용), 1이면 입력 가능
- `screen-output` → 0이면 출력 안 함, 1이면 출력
- `screen-required` → 1이면 필수 입력 표시
- `screen-intensified` → 1이면 필드 강조 표시
- `screen-display_3d` → 1이면 3D 스타일, 0이면 Flat 스타일
```abap
*************** TOP ****************
DATA: gs_booking TYPE sbook.

SELECT-OPTIONS:
  so_car FOR gs_booking-carrid,
  so_con FOR gs_booking-connid MODIF ID abc.

*************** E01 ****************
AT SELECTION-SCREEN OUTPUT.

  LOOP AT SCREEN.
    IF screen-name CS 'SO_CON'
       OR screen-group1 = 'ABC'.
      screen-active = 0.
      MODIFY SCREEN.
    ENDIF.
  ENDLOOP.
```
</br>
</br>

---

</br>

## < 실습 코드 >
</br>

### 실습 1
</br>

- 문제
  
<img width="554" height="250" alt="image" src="https://github.com/user-attachments/assets/ca025a6b-eab5-4677-bdfb-d307ad114460" />
</br>
</br>
</br>
</br>

- `TOP` 모듈 생성
```abap
*&---------------------------------------------------------------------*
*& Include          ZBC400_B03_PRACTICE5_TOP
*&---------------------------------------------------------------------*

DATA: gs_flight TYPE dv_flights.

PARAMETERS: pa_name TYPE c LENGTH 3.
SELECT-OPTIONS: so_car FOR gs_flight-carrid,
                so_con FOR gs_flight-connid.

SELECTION-SCREEN SKIP 2.

SELECTION-SCREEN BEGIN OF BLOCK blk1 WITH FRAME TITLE TEXT-001.
  SELECTION-SCREEN SKIP 2.

  SELECTION-SCREEN BEGIN OF LINE.
    SELECTION-SCREEN COMMENT 1(15) TEXT-003.
    SELECTION-SCREEN COMMENT 35(10) TEXT-004.
    PARAMETERS: pa_abap AS CHECKBOX.
    SELECTION-SCREEN COMMENT 60(10) TEXT-005.
    PARAMETERS: pa_fiori AS CHECKBOX.
  SELECTION-SCREEN END OF LINE.

  SELECTION-SCREEN SKIP 2.
  SELECTION-SCREEN BEGIN OF BLOCK blk2 WITH FRAME TITLE TEXT-002.
    PARAMETERS: pa_all RADIOBUTTON GROUP rad,
                pa_nat RADIOBUTTON GROUP rad,
                pa_int RADIOBUTTON GROUP rad DEFAULT 'X'.
  SELECTION-SCREEN END OF BLOCK blk2.
SELECTION-SCREEN END OF BLOCK blk1.
```
</br>

- `E01` 모듈 생성
```abap
*&---------------------------------------------------------------------*
*& Include          ZBC400_B03_PRACTICE5_E01
*&---------------------------------------------------------------------*

INITIALIZATION.
  so_car-sign = 'I'.
  so_car-option = 'BT'.
  so_car-low = 'AA'.
  so_car-high = 'QF'.
  APPEND so_car.

  CLEAR so_car.
  so_car-sign = 'E'.
  so_car-option = 'EQ'.
  so_car-low = 'LH'.
  APPEND so_car.

AT SELECTION-SCREEN ON RADIOBUTTON GROUP rad.
  IF pa_all = 'X'.
    MESSAGE 'ERROR !' TYPE 'E'.
  ENDIF.
```
</br>

- 결과 확인
  
<img width="554" height="262" alt="image" src="https://github.com/user-attachments/assets/250511f8-7d2d-4ce1-82a2-7ab4724209c0" />
</br>

- PA_ALL 선택하고 실행하면 에러 발생하며 라디오 버튼 그룹만 활성화
<img width="546" height="424" alt="image" src="https://github.com/user-attachments/assets/041c32eb-eb29-4ba4-8681-fb6c6d8ed2b5" />
</br>
</br>
</br>
</br>

### 실습 2
- 전 실습에서 program 27에 이어서 진행
- Selection Screen 필드 제어
- ALV 실습 활용
</br>

- `TOP` 모듈 생성
```abap
*&---------------------------------------------------------------------*
*& Include          ZPROGB03_0027_TOP
*&---------------------------------------------------------------------*

TABLES sscrfields.

DATA: gs_flight TYPE dv_flights,
      gt_flight TYPE TABLE OF dv_flights,
      gv_mode TYPE C VALUE '1'.

" 2025-12-24: SALV 관련 변수 선언
DATA: go_salv TYPE REF TO cl_salv_table.

SELECTION-SCREEN BEGIN OF BLOCK blk1 WITH FRAME TITLE TEXT-001.
  SELECTION-SCREEN SKIP 2.
  "버튼 추가. 버튼명:gv_text, 버튼코드: ON
  SELECTION-SCREEN PUSHBUTTON pos_low(20) gv_text USER-COMMAND ON.

  PARAMETERS: pa_rad1 RADIOBUTTON GROUP rad,
              pa_rad2 RADIOBUTTON GROUP rad DEFAULT 'X',
              pa_rad3 RADIOBUTTON GROUP rad.
  SELECT-OPTIONS: so_car FOR gs_flight-carrid DEFAULT 'AA' TO 'LH' OPTION BT SIGN E,
                  so_con FOR gs_flight-connid DEFAULT '0017' NO-EXTENSION. " NO INTERVALS

SELECTION-SCREEN END OF BLOCK blk1.
```
</br>

- `E01` 모듈 생성
```abap
*&---------------------------------------------------------------------*
*& Include          ZPROGB03_0027_E01
*&---------------------------------------------------------------------*

INITIALIZATION.
  tab_strip-activetab ='COMM3'.
  tab_strip-dynnr = '0103'. " 초기 스크린 설정

  gv_text = '잠금 적용'.

AT SELECTION-SCREEN OUTPUT. " PBO
  LOOP AT SCREEN.
    IF screen-name CS 'RAD3'.
      screen-input = gv_mode.
    ENDIF.
    MODIFY SCREEN.
  ENDLOOP.

AT SELECTION-SCREEN. " PAI
  CHECK sy-dynnr = 1000.
  CASE sscrfields-ucomm.
    WHEN 'ON'.
      IF gv_mode = '1'.
        gv_mode = '0'.
        gv_text = '잠금해제'.
      ELSE.
        gv_mode = '1'.
        gv_text = '잠금 적용'.
      ENDIF.
    WHEN OTHERS.
  ENDCASE.
```
</br>

- ALV 적용 방식
- `Pattern` 클릭 후'ABAP Objects Patterns' 더블클릭
<img width="579" height="307" alt="image" src="https://github.com/user-attachments/assets/1f21c1ac-9374-4ca0-9ae2-f645d5ea9a68" />
</br>
</br>

<img width="351" height="333" alt="image" src="https://github.com/user-attachments/assets/101a0700-8bac-448b-ae9b-632edf5a6447" />
</br>
</br>
</br>

- 결과 확인

<img width="543" height="292" alt="image" src="https://github.com/user-attachments/assets/a1325d18-9403-4923-9f58-8691794b55e1" />
</br>
</br>

- 버튼 누르면 잠금
<img width="548" height="298" alt="image" src="https://github.com/user-attachments/assets/95dc1dfe-6b7e-4887-9985-226981e7421e" />
</br>
</br>

- ALV 이용하여 출력
<img width="543" height="176" alt="image" src="https://github.com/user-attachments/assets/571dc55b-d20f-4b93-9d2c-378d8d026ebd" />

</br>
</br>
</br>
</br>

### 실습 3
- `Pushbutton` 을 이용한 `Selection Screen` 필드 제어 실습
- 전 실습(exercise)에서 이어서 진행
</br>
</br>

**1) 프로그램 최초 실행**
- `INITIALIZATION` 실행
  → `AT SELECTION-SCREEN OUTPUT(PBO, 1000)`
  → `AT SELECTION-SCREEN OUTPUT(PBO, 1200)`
  → 화면 표시
  
**2) 탭을 1100번으로 이동**
- `AT SELECTION-SCREEN OUTPUT(PAI, 1200)`
  → `AT SELECTION-SCREEN OUTPUT(PAI, 1000)`
  → `AT SELECTION-SCREEN OUTPUT(PBO, 1000)`
  → `AT SELECTION-SCREEN(PBO, 1100)`
  → 1100 화면 출력
  
**3) 1100 화면에서 HIDE 버튼 클릭**
- 버튼 클릭
  → `AT SELECTION-SCREEN(PAI, 1100)`
  → `AT SELECTION-SCREEN OUTPUT(PAI, 1000)`
</br>
</br>
</br>

- `TOP` 모듈 수정
```abap
*&---------------------------------------------------------------------*
*& Include          ZBC400_B03_PRACTICE4_TOP
*&---------------------------------------------------------------------*

TABLES SSCRFIELDS.

DATA: gs_flight TYPE dv_flights,
      gt_flight TYPE TABLE OF dv_flights,
      gv_mode TYPE I VALUE 1.

SELECTION-SCREEN BEGIN OF SCREEN 1100 AS SUBSCREEN.
  SELECT-OPTIONS: so_car FOR gs_flight-carrid MEMORY ID car,
                  so_con FOR gs_flight-connid.
  SELECTION-SCREEN SKIP 2.
  SELECTION-SCREEN PUSHBUTTON 1(10) gv_text USER-COMMAND hide.
  SELECTION-SCREEN SKIP 1.
  SELECTION-SCREEN BEGIN OF BLOCK blk1 WITH FRAME TITLE TEXT-001.
    SELECT-OPTIONS: so_cif FOR gs_flight-cityfrom MODIF ID grp,
                    so_cit FOR gs_flight-cityto MODIF ID grp.
  SELECTION-SCREEN END OF BLOCK blk1.
SELECTION-SCREEN END OF SCREEN 1100.
```
</br>

- `E01` 모듈 수정
```abap
*&---------------------------------------------------------------------*
*& Include          ZBC400_B03_PRACTICE4_E01
*&---------------------------------------------------------------------*

INITIALIZATION.
  so_car-sign = 'I'.
  so_car-option = 'BT'.
  so_car-low = 'AA'.
  so_car-high = 'QZ'.
  APPEND so_car.

  CLEAR so_car.
  so_car-sign = 'E'.
  so_car-option = 'EQ'.
  so_car-low = 'AZ'.
  APPEND so_car.

  tab_strip-activetab = 'COMM2'.
  tab_strip-dynnr = '1200'.

  gv_text = '숨김모드 적용'.

AT SELECTION-SCREEN OUTPUT.
*  CHECK sy-dynnr = 1100.  " IF sy-dynnr = 1100. 도 가능
  LOOP AT SCREEN.
    IF screen-group1 = 'GRP'.
      screen-active = gv_mode.
      MODIFY SCREEN.
    ENDIF.
  ENDLOOP.

AT SELECTION-SCREEN.
  CHECK sy-dynnr = 1100.  " 1100번일때만 로직 실행
  CASE SSCRFIELDS-ucomm.
    WHEN 'HIDE'.
      IF gv_mode = 1.
        gv_mode = 0.
        gv_text = '숨김모드 해제'.
      ELSE.
        gv_mode = 1.
        gv_text = '숨김모드 적용'.
      ENDIF.
    WHEN OTHERS.
  ENDCASE.
```
</br>

- 결과 확인
<img width="578" height="221" alt="image" src="https://github.com/user-attachments/assets/72062d90-598c-41b5-b648-f9e50eb3c5c1" />
</br>
</br>

- 버튼 클릭하면 입력창이 숨겨짐
<img width="579" height="222" alt="image" src="https://github.com/user-attachments/assets/0045c78e-b46c-439c-8095-df18e8af3f99" />
</br>
</br>
</br>
</br>

### 실습 4 (과제)
- 문제
- `FOR ALL ENTRIES IN <itab>` 사용
- `LOOP AT <itab> … ENDLOOP` 사용
- `READ TABLE <itab> INTO .. WITH KEY …` 사용
- `SORT <itab>` 사용
<img width="501" height="553" alt="image" src="https://github.com/user-attachments/assets/35361289-6707-4c88-a1fd-94288881aefd" />
</br>
</br>
</br>
</br>

- `TOP` 모듈 생성
```abap
*&---------------------------------------------------------------------*
*& Include          ZBC400_B03_PRACTICE6_TOP
*&---------------------------------------------------------------------*

DATA: gs_scarr TYPE scarr,
      gt_scarr TYPE TABLE OF scarr.

DATA: BEGIN OF gs_data,
        carrid    TYPE s_carr_id,     "DV_FLIGHTS
        carrname  TYPE s_carrname,    "SCARR
        connid    TYPE s_conn_id,     "DV_FLIGHTS
        fldate    TYPE s_date,        "DV_FLIGHTS
        cityfrom  TYPE s_from_cit,    "DV_FLIGHTS
        cityto    TYPE s_to_city,     "DV_FLIGHTS
        countryfr TYPE land1,         "DV_FLIGHTS
        countryto TYPE land1,         "DV_FLIGHTS
      END OF gs_data.
DATA: gt_data LIKE TABLE OF gs_data.

SELECT-OPTIONS: SO_CAR FOR gs_data-carrid,
                SO_CON FOR gs_data-connid,
                SO_FDT FOR gs_data-fldate NO INTERVALS.

DATA: go_salv TYPE REF TO cl_salv_table.
```
</br>

- `E01` 모듈 수정
```abap
*&---------------------------------------------------------------------*
*& Include          ZBC400_B03_PRACTICE6_E01
*&---------------------------------------------------------------------*

INITIALIZATION.
  SO_car-sign = 'I'.
  so_car-option = 'BT'.
  so_car-low = 'AA'.
  so_car-high = 'QF'.
  APPEND so_car.

START-OF-SELECTION.
  SELECT * FROM dv_flights
    INTO CORRESPONDING FIELDS OF TABLE gt_data
    WHERE carrid IN SO_car
      AND connid IN SO_con
      AND fldate IN SO_fdt.

  MOVE-CORRESPONDING gt_data TO gt_copy_data.

  SORT gt_copy_data BY carrid.
  DELETE ADJACENT DUPLICATES FROM gt_copy_data COMPARING carrid.

  " scarr에서 dv_flights의 carrid 에 맞는 데이터 뽑기
  SELECT carrid carrname FROM scarr
    INTO TABLE gt_scarr
    FOR ALL ENTRIES IN gt_copy_data
    WHERE carrid = gt_copy_data-carrid.

  LOOP AT gt_data INTO gs_data.
    READ TABLE gt_scarr INTO gs_scarr WITH KEY carrid = gs_data-carrid.
    gs_data-carrname = gs_scarr-carrname.
    MODIFY gt_data FROM gs_data.
  ENDLOOP.

  SORT gt_data BY carrid connid fldate ASCENDING.

  TRY.
      CALL METHOD cl_salv_table=>factory
        IMPORTING
          r_salv_table = go_salv
        CHANGING
          t_table      = gt_data.
    CATCH cx_salv_msg.
      MESSAGE 'Error !' TYPE 'E'.
  ENDTRY.

  go_salv->get_functions( )->set_all( abap_true ).
  go_salv->display( ).
```
</br>

- 결과 확인
<img width="460" height="407" alt="image" src="https://github.com/user-attachments/assets/d34e516b-a7ed-4f27-9a7f-78410d3f9406" />
