## < ABAP 문법 정리 >
</br>

### 1) WITH HEADER LINE
- 내부 테이블 안에 자동으로 한 줄(row)을 나타내는 구조를 생성
- 테이블 이름과 동일한 구조가 만들어져 별도 워크에어리어 없이 한 줄 데이터를 바로 사용 가능
  - `itab[]` → 테이블 전체
  - `itab` → 테이블의 헤더라인(한 줄)
```abap
DATA: <itab> TYPE TABLE OF <structure> WITH HEADER LINE.
```
- INTO 절 생략 가능
```abap
LOOP AT gt_hline.
  WRITE: gt_hline-carrid.  "헤더 라인 사용 덕분에 INTO 생략 가능
ENDLOOP.
```
- MODIFY 시 자동 참조
```abap
gt_hline-percentage = gt_hline-seatsocc * 100 / gt_hline-seatsmax.
MODIFY gt_hline.  "워크 에어리어(gt_hline)를 테이블에 적용
```
- 실습
```abap
" Header Line이 있는 Internal table 선언
" gt_hline은 Structure, gt_hline[] 은 Itab 이 된다.
DATA: gt_hline TYPE TABLE OF bc400_s_flight WITH HEADER LINE.

SELECT carrid connid fldate seatsmax seatsocc
  FROM sflight
  INTO TABLE gt_hline[]
  WHERE carrid = 'AA'.

IF ( sy-subrc = 0 ).
  LOOP AT gt_hline.       " INTO 절 생략 가능
    gt_hline-percentage = gt_hline-seatsocc * 100 / gt_hline-seatsmax.
    MODIFY gt_hline.
  ENDLOOP.
ENDIF.

SORT gt_hline[] BY connid ASCENDING
                   percentage DESCENDING.

CLEAR gt_hline.
LOOP AT gt_hline WHERE percentage > 80.
  WRITE:/ gt_hline-carrid,
          gt_hline-connid,
          gt_hline-fldate,
          gt_hline-seatsmax,
          gt_hline-seatsocc,
          gt_hline-percentage.
ENDLOOP.
```
</br>
</br>

---

</br>

## < ABAP 개념 정리 >
</br>

### Selection Screen 주요 특징
- 실행 버튼 누르면 DB 테이블에서 조건에 맞는 데이터 추출
- 다국어 처리 지원
- 입력 값 타입 자동 체크 (예: 숫자, 날짜, 문자열)
- 입력 값 저장 및 재사용 가능
- 복잡한 조건(범위, 다중 선택 등) 처리 가능
- 입력 값 범위 및 형식 제한 기능 (F4 도움말 등)
</br>

### 파라미터 선언 예시 및 특징
- `TYPE` 뒤에 올 수 있는 타입은 표준 타입 혹은 데이터 딕셔너리 필드 타입
- 파라미터는 단일 입력값 받음
- 입력 필드의 데이터 타입이 자동 적용됨 (숫자, 문자열 등)
```abap
PARAMETERS: pa_car TYPE s_carr_id.
PARAMETERS: pa_car TYPE spfli-carrid.
```
</br>

### Select-Options 관련 주요 사항
- 선언 시 `TYPE`이 아니라 `FOR` 키워드 사용
```abap
SELECT-OPTIONS: so_car FOR spfli-carrid.
```
- FOR 뒤에는 이미 선언된 데이터 오브젝트나 DDIC 필드명을 사용
- Select-options는 내부적으로 테이블(ITAB) 구조를 가짐
- Select-options 로 입력된 범위값을 사용할 때는 IN 키워드 사용
- 만약 so_car가 빈 값이면 조건 없이 전체 조회됨
```abap
SELECT * FROM spfli WHERE carrid IN so_car.
```
</br>

### ITAB 필드 정의

| 필드명 | 의미 |
|--------|------|
| SIGN   | 포함(I, Include) 또는 제외(E, Exclude) |
| OPTION | 연산자 (EQ = 같음, BT = 범위, GE = 이상 등) |
| LOW    | 범위 시작값 (From) |
| HIGH   | 범위 끝값 (To, BT 연산자에서 사용) |

- 예시

| 조건 설명                          | SIGN | OPTION | LOW  | HIGH |
|-----------------------------------|------|--------|------|------|
| LH 값만 포함                        | I    | EQ     | LH   |      |
| AA부터 DL까지 포함                  | I    | BT     | AA   | DL   |
| BA 값 제외                          | E    | EQ     | BA   |      |

</br>
</br>

---

</br>

## < 실습 코드 >
- 실습 1
```abap
DATA: gs_data TYPE SBOOK,
      gt_data LIKE TABLE OF gs_data.

PARAMETERS: pa_car TYPE S_CARR_ID DEFAULT 'AZ',
            pa_con TYPE S_CONN_ID DEFAULT '0555'.

SELECT-OPTIONS: so_dat FOR gs_data-FLDATE.


SELECT * FROM SBOOK
  INTO CORRESPONDING FIELDS OF TABLE gt_data
  WHERE CARRID = pa_car
    AND CONNID = pa_con
    AND FLDATE IN so_dat.

LOOP AT gt_data INTO gs_data.
  WRITE:/ gs_data-CARRID, gs_data-CONNID, gs_data-FLDATE,
          gs_data-BOOKID, gs_data-CUSTOMID, gs_data-CUSTTYPE.
ENDLOOP.
```
