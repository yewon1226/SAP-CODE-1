## <  핵심 개념 >
- **1) ODataModel은 `getData()` / `getDate()` 같은 직접 접근 불가이고, 데이터는 `read()` 콜백이나 바인딩된 컨텍스트(`getBindingContext().getProperty()`)로만 가져올 수 있음**
- **2) `read()` 는 ODataModel만 가능, JSONModel은 `setData/getData` 로 직접 다룸**
- **3) `content aggregation` 은 하나만 가능해서 여러 컨트롤 쓰려면 `VBox` 같은 컨테이너로 감싸야 함**
- **4) `GET_ENTITY` / `GET_ENTITYSET` 은 read 호출할 때만 의미 있음**

</br>
</br>

---

</br>

## < Filter 연결 >
</br>

- `it_filter_select_options` → OData 필터를 필드별 SELECT-OPTIONS 구조로 파싱해서 전달하는 내부 테이블
- `iv_filter_string` → OData $filter 조건을 문자열 그대로 전달한 WHERE 절용 필터 문자열
- `WHERE (변수)` 는 문자열을 SQL 조건식으로 해석하는 ABAP의 동적 WHERE 문법

```java
// project1

onReadEntitySet: function() {
    // new Filter(path, operator, value1, value2(operator가 BT 인 경우에 씀))
    
    // let aFilter = []
    // let oFilter = new Filter("Memo", FilterOperator.Contains, "TEST2 MEMO");
    // aFilter.push(oFilter);
    let oDateFormat = sap.ui.core.format.DateFormat.getInstance({
        pattern: "yyyyMMdd",
        UTC: true
    });
    let oStartDate = oDateFormat.parse("20260119");
    let oEndDate = oDateFormat.parse("20260701");

    let oFilter = [];
    oFilter.push(new Filter("Memo", FilterOperator.Contains, "TEST2 MEMO"));
    // oFilter.push(new Filter("Role", FilterOperator.Contains, "TEST2"));
    // oFilter.push(new Filter("Projod", FilterOperator.NE, "TEST2")); // 5000번 데이터 띄우기
    oFilter.push(new Filter("Assigndate", FilterOperator.BT, oStartDate, oEndDate));

    this.oModel.read("/EmployeeSet", {
        filters: oFilter, //aFilters,
        success: function(oReturn) {
            sap.m.MessageToast.show("조회 완료, 콘솔창 확인!");
            console.log("onReadEntitySet 전체 조회 성공 : ", oReturn.results);
        }
    })
}
```
```abap
" ZCL_ZGWEMP_B03_DPC_EXT : EMPLOYEESET_GET_ENTITYSET

  method EMPLOYEESET_GET_ENTITYSET.
    DATA: lv_where_clause TYPE string.
        " 전체 필터 조건을 SQL WHERE 절 문자열로 변환
        lv_where_clause = io_tech_request_context->get_osql_where_clause( ).
        SELECT * FROM ztempinfo_b03
          INTO CORRESPONDING FIELDS OF TABLE et_entityset
          WHERE (lv_where_clause).
*    DATA: lr_memo TYPE /IWBEP/T_COD_SELECT_OPTIONS,
*          lr_role TYPE /IWBEP/T_COD_SELECT_OPTIONS,
*          lr_projod TYPE /IWBEP/T_COD_SELECT_OPTIONS,
*          lr_date TYPE /IWBEP/T_COD_SELECT_OPTIONS.
*
*    IF it_filter_select_options IS INITIAL.
*      SELECT * FROM ztempinfo_b03
*        INTO CORRESPONDING FIELDS OF TABLE et_entityset.
*    ELSE.
*      " 만약 필터 정보가 들어왔다면, 필터 적용
*      LOOP AT it_filter_select_options INTO DATA(ls_filter).
*        CASE ls_filter-property.
*          WHEN 'Memo'.
*            APPEND LINES OF ls_filter-select_options TO lr_memo.
*          WHEN 'Role'.
*            APPEND LINES OF ls_filter-select_options TO lr_role.
*          WHEN 'Projod'.
*            APPEND LINES OF ls_filter-select_options TO lr_projod.
*          WHEN 'Assigndate'.
*            APPEND LINES OF ls_filter-select_options TO lr_date.
*          WHEN OTHERS.
*        ENDCASE.
*      ENDLOOP.
*
*      SELECT * FROM ztempinfo_b03
*        INTO CORRESPONDING FIELDS OF TABLE et_entityset
*        WHERE Memo IN lr_memo
*          AND Role IN lr_role
*          AND projod IN lr_projod
*          AND assigndate IN lr_date.
*    ENDIF.
**********************************************************************
*    IF iv_filter_string IS INITIAL.
*      SELECT * FROM ztempinfo_b03
*        INTO CORRESPONDING FIELDS OF TABLE et_entityset.
*    ELSE.
*      SELECT * FROM ztempinfo_b03
*        INTO CORRESPONDING FIELDS OF TABLE et_entityset
*        WHERE (iv_filter_string).
*    ENDIF.
  endmethod.
```
</br>
</br>

---

</br>

## < sap.ui.model.odata.v2.ODataModel CRUD 메서드 정리 >
</br>

### 1) UTC 기준 Date 처리 및 DatePicker
- `UTC` → 전 세계 공통으로 사용하는 표준 시간 기준
- `UTC+9` → 한국에서 사용하는 현지 시간 기준 (UTC보다 9시간 빠름)
- UTC/UTC+9 혼용 시 날짜·시간 변환 과정에서 하루 밀림(±1일) 오류가 발생할 수 있음
</br>
</br>

- `sap.ui.core.format.DateFormat.getInstance({ pattern: "yyyyMMdd", UTC: true })` → 날짜를 UTC 기준으로 yyyyMMdd 형식 문자열로 변환하는 포맷 객체 생성
- `format()` → Date / Number 객체를 문자열로 변환하는 함수
- `parse()` → 문자열을 Date / Number 객체로 변환하는 함수
```java
let oDateFormat = sap.ui.core.format.DateFormat.getInstance({
  pattern: "yyyy-MM-dd",
  UTC: true
});

oDateFormat.format(oDate);   // Date → 문자열
oDateFormat.parse("2026-02-03"); // 문자열 → Date
```
- 서버 DateTime → 문자열로 표시
- JS Date → `sap.ui.model.type.Date`, OData DateTime 문자열 → `sap.ui.model.odata.type.DateTime`, formatter는 선택
```html
<Text text="{
  path: 'Writedate',
  type: 'sap.ui.model.odata.type.DateTime',
  formatOptions: { pattern: 'yyyy-MM-dd' }
}" />
```
</br>
</br>

- DatePicker는 화면 표시용(displayFormat)과 내부 처리용(value/valueFormat, dateValue)을 분리해 날짜 입력·처리를 안정적으로 하는 컨트롤
```html
<DatePicker
    displayFormat="yyyy-MM-dd"   <!-- 화면에 보이는 날짜 형식 -->
    valueFormat="yyyy-MM-dd"     <!-- 내부에서 문자열로 관리되는 형식 -->
    value="2026-02-03"            <!-- 문자열(String) 값 바인딩 -->
    dateValue="{/Writedate}"      <!-- Date 객체(Date) 바인딩 -->
/>
```
</br>
</br>

### 1) Create 
- `?` 가 들어간 파라미터는 옵셔널, 아닌 것은 필수 값
<img width="592" height="35" alt="image" src="https://github.com/user-attachments/assets/34eb1a57-53c3-4fd0-90d2-92390d1e19a5" />

</br>

- `alt` 로 선택 후에 `Ctrl + shift + 화살표 =>` 누르면 한번에 선택 가능
