## <  핵심 개념 >
</br>

- **1) `module pool program` 생성 방법 ( 일반 프로그램 생성 방법에서 include 파일 포함 )**
- **2) 모듈풀 프로그램은 무조건 `TCODE` 생성해야 함**

</br>

---

</br>

## < ABAP Expressions(표현식) 기본 개념 정리 >
</br>

### 1) replace
- 문자열에서 지정한 부분(sub)을 다른 문자열(with)로 바꾼 새 문자열을 반환하는 문자열 처리 함수
- 대소문자 구분 여부를 case 옵션으로 제어 가능
```abap
RESULT = replace(
           val  = <원본문자열>
           sub  = <찾을문자열>
           case = abap_false   " 대소문자 구분 안 함 (abap_true면 구분)
           with = <바꿀문자열>
         ).
```
</br>

### 2) 문자열 연결 (Concatenation)
- 여러 문자열을 하나로 이어서 새 문자열을 만듦
```abap
*************** 기존 방식 ****************
CONCATENATE gv_var1 gv_var2
  INTO gv_result
  SEPARATED BY <sep>.

*************** 최신 방식 ****************
gv_result = gv_var1 && gv_var2.
```
</br>

### 3) 문자열 템플릿 (String Templates)
- 문자열 안에 변수나 표현식을 직접 삽입해 새 문자열을 만듦
```abap
*************** 기존 방식 ****************
DATA gv_string TYPE string.
gv_string = |Hello World|.

*************** 최신 방식 ****************
DATA gv_string TYPE string.
PARAMETERS pa_name TYPE string.
gv_string = |Hello { pa_name }|.
```
</br>
</br>

### 4) SET COUNTRY / DATE FORMAT
- 국가(로케일) 기준에 맞게 날짜·숫자 등의 출력 형식을 설정하는 환경 설정 명령
```abap
SET COUNTRY 'US'.
SET DATE FORMAT 'ENVIRONMENT'.
```
</br>
</br>

---

</br>

## < 실습 코드 >
</br>

### 실습 1
- 엑셀 업로드 연습
```abap
REPORT ZBC400_B03_PRACTICE13.

TYPES: BEGIN OF ts_data,
        ID(20),
        NAME(20),
        AGE(20),
        ADDRESS(20),
       END OF ts_data.


PARAMETERS: pa_file TYPE localfile.
DATA: gt_filename TYPE filetable,
      gv_rc TYPE I,
      gt_excel_data TYPE TABLE OF alsmex_tabline.
DATA: gt_data TYPE TABLE OF ts_data,
      gs_data LIKE LINE OF gt_data.
FIELD-SYMBOLS: <fs> TYPE ANY.
CONSTANTS gc_filters TYPE string VALUE 'EXCEL FILES (*.XLSX)|*.XLSX|EXCEL FILES (*.XLS)|*.XLS|'.

AT SELECTION-SCREEN ON VALUE-REQUEST FOR pa_file.
  cl_gui_frontend_services=>file_open_dialog(
    EXPORTING
      window_title            = '파일찾기'                 " Title Of File Open Dialog
      default_filename        = space                 " Default File Name
      file_filter             = gc_filters                 " File Extension Filter String
      initial_directory       = 'C:'                 " Initial Directory
    CHANGING
      file_table              = gt_filename                 " Table Holding Selected Files
      rc                      = gv_rc                 " Return Code, Number of Files or -1 If Error Occurred
    EXCEPTIONS
      file_open_dialog_failed = 1                " "Open File" dialog failed
      cntl_error              = 2                " Control error
      error_no_gui            = 3                " No GUI available
      not_supported_by_gui    = 4                " GUI does not support this
      others                  = 5
  ).
  IF SY-SUBRC = 0.
    READ TABLE gt_filename INTO pa_file INDEX 1.
  ENDIF.

START-OF-SELECTION.
  IF pa_file IS NOT INITIAL.
    CALL FUNCTION 'ALSM_EXCEL_TO_INTERNAL_TABLE'
      EXPORTING
        filename                = pa_file
        i_begin_col             = 2
        i_begin_row             = 5
        i_end_col               = 5
        i_end_row               = 50
      TABLES
        intern                  = gt_excel_data
      EXCEPTIONS
        inconsistent_parameters = 1
        upload_ole              = 2
        others                  = 3.
    IF SY-SUBRC = 0.
      SORT gt_excel_data BY row col.
      LOOP AT gt_excel_data INTO DATA(gs_excel_data).
        UNASSIGN <fs>.
        ASSIGN COMPONENT gs_excel_data-col OF STRUCTURE gs_data TO <fs>.
        <fs> = gs_excel_data-value.

        AT END OF row.
          APPEND gs_data TO gt_data.
          CLEAR gs_data.
        ENDAT.
      ENDLOOP.
      cl_demo_output=>display( gt_data ).
    ENDIF.
  ENDIF.
```
