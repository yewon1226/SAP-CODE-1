## <  핵심 개념 >
- **1) 조회(GET)는 HTTP 가능, 데이터 변경(Create/Update/Delete)은 HTTPS 필수**
</br>
</br>

---

</br>

## < Header–Item 구조 OData 서비스 구현 >
</br>

### 1) Read (GET)
</br>

**1) HEADERSET_GET_ENTITYSET**
- Header 엔티티 전체 목록을 조회하는 기본 EntitySet 조회 메서드
```abap
" ZCL_ZGWHEADITEM_B03_DPC_EXT : HEADERSET_GET_ENTITYSET

  method HEADERSET_GET_ENTITYSET.
    SELECT * FROM zscarrcl2_b03
      INTO TABLE et_entityset.
  endmethod.
```
</br>

**2) ITEMSET_GET_ENTITYSET**
- 특정 Header(Carrid)에 속한 Item 목록을 조회하는 Item EntitySet 메서드
```abap
" ZCL_ZGWHEADITEM_B03_DPC_EXT : ITEMSET_GET_ENTITYSET

  method ITEMSET_GET_ENTITYSET.
    DATA lv_carrid TYPE s_carr_id.
    DATA lt_data TYPE TABLE OF zspflicl2_b03.

    LOOP AT it_key_tab INTO DATA(ls_key).
      IF ls_key-name EQ 'Carrid'.
        MOVE ls_key-value TO lv_carrid.
      ENDIF.
    ENDLOOP.

    SELECT * FROM ZSPFLICL2_B03
      INTO TABLE lt_data
      WHERE carrid = lv_carrid.
    IF sy-subrc = 0.
      MOVE-CORRESPONDING lt_data TO et_entityset.
    ENDIF.
  endmethod.
```
</br>

**3) /IWBEP/IF_MGW_APPL_SRV_RUNTIME~GET_EXPANDED_ENTITY**
- `$expand` 요청 시 Header 1건과 연관된 ItemSet을 함께 조회해 한 번에 반환하는 메서드
</br>

- `copy_data_to_ref` → ABAP 내부 구조(또는 테이블) 데이터를 OData 응답(`er_entity` / `er_entityset`)으로 변환·출력하는 메서드
- `lv_nav = 'ITEMSET'` → `$expand` 로 처리한 Navigation Property(ItemSet) 이름을 Gateway에 알려주는 값
- `et_expanded_tech_clauses` → `$expand` 요청 중 실제로 처리한 Navigation Property들을 Gateway에 전달하는 파라미터
- `er_entity` → 조회·가공된 단일 Entity 결과를 OData 응답으로 내려보내는 출력 파라미터

<img width="518" height="323" alt="image" src="https://github.com/user-attachments/assets/21524dd0-fb91-4aac-b01a-26cedd4070d5" />

```abap
" ZCL_ZGWHEADITEM_B03_DPC_EXT : /IWBEP/IF_MGW_APPL_SRV_RUNTIME~GET_EXPANDED_ENTITY

  method /IWBEP/IF_MGW_APPL_SRV_RUNTIME~GET_EXPANDED_ENTITY.
    TYPES BEGIN OF ty_headeritem.
      INCLUDE TYPE ZCL_ZGWHEADITEM_B03_MPC=>ts_header.
      TYPES ItemSet TYPE TABLE OF ZCL_ZGWHEADITEM_B03_MPC=>ts_item WITH DEFAULT KEY.
    TYPES END OF ty_headeritem.
    DATA: lv_carrid TYPE s_carr_id,
          ls_header_item TYPE ty_headeritem,
          lv_nav TYPE string VALUE 'ITEMSET'.

    LOOP AT it_key_tab INTO DATA(ls_key).
      IF ls_key-name EQ 'Carrid'.
        MOVE ls_key-value TO lv_carrid.
      ENDIF.
    ENDLOOP.

    " Header 조회
    SELECT SINGLE * FROM zscarrcl2_b03
      INTO CORRESPONDING FIELDS OF ls_header_item
      WHERE carrid = lv_carrid.
    if sy-subrc = 0.
      " Item 조회 (Navigation Property 이름에 맞춰 데이터 채움)
      SELECT * FROM zspflicl2_b03
        INTO CORRESPONDING FIELDS OF TABLE ls_header_item-itemset
        WHERE carrid = lv_carrid.
    ENDIF.

    " 결과 출력(ER_ENTITY)
    copy_data_to_ref(
      EXPORTING is_data = ls_header_item
      CHANGING cr_data = er_entity ).

    " Navigation Property 데이터 처리 완료되었다고 알려주는 파라미터
    INSERT lv_nav INTO TABLE et_expanded_tech_clauses.
  endmethod.
```
</br>

**4) /IWBEP/IF_MGW_APPL_SRV_RUNTIME~GET_EXPANDED_ENTITYSET**
- `$expand` 요청으로 Header 여러 건과 각 Header의 ItemSet을 함께 조회할 때 사용하는 메서드
</br>

- `copy_data_to_ref` → ABAP 내부 구조(또는 테이블) 데이터를 OData 응답(`er_entity` / `er_entityset`)으로 변환·출력하는 메서드
- `lv_nav = 'ITEMSET'` → `$expand` 로 처리한 Navigation Property(ItemSet) 이름을 Gateway에 알려주는 값
- `et_expanded_tech_clauses` → `$expand` 요청 중 실제로 처리한 Navigation Property들을 Gateway에 전달하는 파라미터
- `er_entityset` → 조회·가공된 결과(Entity 여러 건)를 OData 응답으로 내려보내는 출력 파라미터
```abap
" ZCL_ZGWHEADITEM_B03_DPC_EXT : /IWBEP/IF_MGW_APPL_SRV_RUNTIME~GET_EXPANDED_ENTITYSET

  method /IWBEP/IF_MGW_APPL_SRV_RUNTIME~GET_EXPANDED_ENTITYSET.
    TYPES BEGIN OF ts_headeritem.
      INCLUDE TYPE ZCL_ZGWHEADITEM_B03_MPC=>ts_header.
      TYPES ItemSet TYPE TABLE OF ZCL_ZGWHEADITEM_B03_MPC=>ts_item WITH DEFAULT KEY.
    TYPES END OF ts_headeritem.

    TYPES tt_headeritem TYPE STANDARD TABLE OF
      ts_headeritem WITH DEFAULT KEY.

    DATA: lt_header_item_set TYPE tt_headeritem,
          lt_header_db TYPE TABLE OF ZSCARRCL2_B03,
          lt_item_db TYPE TABLE OF ZSPFLICL2_B03,
          lv_nav TYPE string VALUE 'ITEMSET'.
    FIELD-SYMBOLS <fs> TYPE ts_headeritem.

    " 1. Header 조회하고, Headeritem 구조체에 헤더 적용
    SELECT * FROM zscarrcl2_b03
      INTO TABLE lt_header_db.
    IF sy-subrc = 0.
      MOVE-CORRESPONDING lt_header_db TO lt_header_item_set.

      " 2-1. Header에 맞는 Item 조회
      SELECT * FROM zspflicl2_b03
        FOR ALL ENTRIES IN @lt_header_db
        WHERE carrid = @lt_header_db-carrid
        INTO TABLE @lt_item_db.

      " 2-2. Item 루프 돌면서, HeaderItem 구조체의 ItemSet테이블에 적용
      LOOP AT lt_item_db ASSIGNING FIELD-SYMBOL(<fs_item>).
        UNASSIGN <fs>.
        ASSIGN lt_header_item_set[ carrid = <fs_item>-carrid ] TO <fs>.
        APPEND <fs_item> TO <fs>-itemset.
      ENDLOOP.

      " 3. 결과 출력 (ER_ENTITYSET)
      copy_data_to_ref(
        EXPORTING is_data = lt_header_item_set
        CHANGING cr_data = er_entityset
      ).
      INSERT lv_nav INTO TABLE et_expanded_tech_clauses.
    ENDIF.
  endmethod.
```
</br>

**5) Get Gateway로 확인 가능**
```html
/HeaderSet?$format=json&$expand=ItemSet
```
<img width="644" height="167" alt="image" src="https://github.com/user-attachments/assets/4f537639-2bc0-48de-8220-705ab26ad9b2" />
</br>
</br>
</br>
</br>

### 2) Create (POST)
- Header 1건과 그에 속한 Item 여러 건을 한 번에 받아 각각의 DB 테이블에 생성한 뒤, 생성 결과를 응답으로 반환하는 메서드
</br>

- `io_data_provider->read_entry_data` → 요청 payload(body)에 담긴 입력 데이터를 ABAP 구조로 읽어오는 메서드
- `er_deep_entity` → Deep Create 수행 후 생성된 Header–Item 구조를 OData 응답으로 반환하는 출력 파라미터
```abap
" ZCL_ZGWHEADITEM_B03_DPC_EXT : /IWBEP/IF_MGW_APPL_SRV_RUNTIME~CREATE_DEEP_ENTITY

  method /IWBEP/IF_MGW_APPL_SRV_RUNTIME~CREATE_DEEP_ENTITY.
    TYPES BEGIN OF ts_headeritem.
      INCLUDE TYPE ZCL_ZGWHEADITEM_B03_MPC=>ts_header.
      TYPES ItemSet TYPE TABLE OF ZCL_ZGWHEADITEM_B03_MPC=>ts_item WITH DEFAULT KEY.
    TYPES END OF ts_headeritem.

    DATA: ls_create_data TYPE ts_headeritem,
          ls_header TYPE ZCL_ZGWHEADITEM_B03_mpc=>ts_header,
          lt_item TYPE ZCL_ZGWHEADITEM_B03_mpc=>tt_item.
    CASE iv_entity_name.
      WHEN 'Header'.
        io_data_provider->read_entry_data(
          IMPORTING es_data = ls_create_data
        ).

        " 받아온 Header-Item 데이터 분리
        MOVE-CORRESPONDING ls_create_data TO ls_header.
        MOVE-CORRESPONDING ls_create_data-itemset TO lt_item.

        " 각 DB Table에 Create
        INSERT zscarrcl2_b03 FROM ls_header.
        IF sy-subrc = 0.
          INSERT zspflicl2_b03 FROM TABLE lt_item.
          IF sy-subrc <> 0.
            ROLLBACK WORK.  " item insert 실패 시 전체 롤백
          ENDIF.
        ENDIF.

        " 결과 출력 (ER_DEEP_ENTITY)
        copy_data_to_ref(
          EXPORTING is_data = ls_create_data
          CHANGING cr_data = er_deep_entity
        ).
    ENDCASE.
  endmethod.
```

<img width="940" height="682" alt="image" src="https://github.com/user-attachments/assets/3ac5c726-7f61-48a0-acf2-67f377e82d8b" />
</br>
</br>
</br>
</br>
</br>
</br>

---

</br>

## < DatePicker / DateRangeSelection 정리 >
</br>

- **CREATE / UPDATE (서버로 전송)** : Date 객체 그대로 사용. 필요 시 `setMinutes(getTimezoneOffset)` 1회
- **READ / FILTER (조회 조건)** : `DateFormat.getInstance({ UTC:true })` 사용. `parse` / `format` 가능
```java
oData.Assigndate.setMinutes(
    oData.Assigndate.getMinutes() - oData.Assigndate.getTimezoneOffset()
);
```
```java
let oDateFormat = sap.ui.core.format.DateFormat.getInstance({
    pattern: "yyyy-MM-dd",
    UTC: true
});
let oStartDate = oDateFormat.parse(oInput.Assigndate);
let oEndDate = oDateFormat.parse("20260701");
```
```html
<!-- 1) type.Date + formatOptions -->
<DatePicker
  value="{
    path: 'oInputModel>/Assigndate',
    type: 'sap.ui.model.type.Date',
    formatOptions: { pattern: 'yyyy-MM-dd' }
  }"
/>

<!-- 2) type.Date + formatOptions (yyyyMMdd) -->
<DatePicker
  value="{
    path: 'oInputModel>/Assigndate',
    type: 'sap.ui.model.type.Date',
    formatOptions: { pattern: 'yyyyMMdd' }
  }"
/>

<!-- 3) valueFormat + displayFormat -->
<DatePicker
  value="{oInputModel>/Assigndate}"
  valueFormat="yyyyMMdd"
  displayFormat="yyyy-MM-dd"
/>

<!-- 4) valueFormat만 -->
<DatePicker
  value="{oInputModel>/Assigndate}"
  valueFormat="yyyyMMdd"
/>

<!-- 5) displayFormat만 -->
<DatePicker
  value="{oInputModel>/Assigndate}"
  displayFormat="yyyy-MM-dd"
/>

<!-- ===================================================== -->
<!-- 6) DateRangeSelection + type.Date + formatOptions -->
<DateRangeSelection
  dateValue="{
    path: 'oInputModel>/StartDate',
    type: 'sap.ui.model.type.Date',
    formatOptions: { pattern: 'yyyy-MM-dd' }
  }"
  secondDateValue="{
    path: 'oInputModel>/EndDate',
    type: 'sap.ui.model.type.Date',
    formatOptions: { pattern: 'yyyy-MM-dd' }
  }"
/>

<!-- 7) DateRangeSelection + valueFormat / displayFormat -->
<DateRangeSelection
  dateValue="{oInputModel>/StartDate}"
  secondDateValue="{oInputModel>/EndDate}"
  valueFormat="yyyyMMdd"
  displayFormat="yyyy-MM-dd"
/>
```
```yaml
[1) type.Date + formatOptions]
화면 : 2026-07-01
JS   : Date 객체
parse() : 필요 없음
의미 : 모델 타입을 Date로 고정, pattern은 화면용

[2) type.Date + formatOptions (yyyyMMdd)]
화면 : 20260701
JS   : Date 객체
parse() : 필요 없음
의미 : 패턴이 달라도 모델은 Date

[3) valueFormat + displayFormat]
화면 : 2026-07-01
JS   : "20260701" (문자열)
parse() : 필요
의미 : valueFormat=모델용, displayFormat=화면용

[4) valueFormat만]
화면 : 20260701
JS   : "20260701"
parse() : 필요
의미 : 화면/모델 포맷 동일, 문자열 기반

[5) displayFormat만]
화면 : 2026-07-01
JS   : 문자열(형식 불명확)
parse() : 상황 따라 필요
의미 : 모델 포맷 제어 안 됨 (비추천)

--------------------------------------------------------

[6) DateRangeSelection + type.Date + formatOptions]
화면 : 2026-07-01 ~ 2026-07-31
JS   : 
  StartDate = Date 객체
  EndDate   = Date 객체
parse() : 필요 없음
의미 : 날짜 범위를 Date 객체로 안전하게 처리 (⭐추천)

[7) DateRangeSelection + valueFormat / displayFormat]
화면 : 2026-07-01 ~ 2026-07-31
JS   :
  StartDate = "20260701"
  EndDate   = "20260731"
parse() : 필요
의미 : 서버/ABAP yyyyMMdd 포맷에 맞춘 범위 검색
```
</br>
</br>
</br>

---

</br>

## < 실습 코드 >
</br>

### 실습 1
- header-item oData 서비스 연결 실습
</br>

**1) SAP GUI 코드**
- `HEADERSET_GET_ENTITYSET`
```abap
" ZCL_ZGWHEADITEM_B03_DPC_EXT : HEADERSET_GET_ENTITYSET

  method HEADERSET_GET_ENTITYSET.
    SELECT * FROM zscarrcl2_b03
      INTO TABLE et_entityset.
  endmethod.
```
- `ITEMSET_GET_ENTITYSET`
```abap
" ZCL_ZGWHEADITEM_B03_DPC_EXT : ITEMSET_GET_ENTITYSET

  method ITEMSET_GET_ENTITYSET.
    DATA lv_carrid TYPE s_carr_id.
    DATA lt_data TYPE TABLE OF zspflicl2_b03.

    LOOP AT it_key_tab INTO DATA(ls_key).
      IF ls_key-name EQ 'Carrid'.
        MOVE ls_key-value TO lv_carrid.
      ENDIF.
    ENDLOOP.

    SELECT * FROM ZSPFLICL2_B03
      INTO TABLE lt_data
      WHERE carrid = lv_carrid.
    IF sy-subrc = 0.
      MOVE-CORRESPONDING lt_data TO et_entityset.
    ENDIF.
  endmethod.
```
- `/IWBEP/IF_MGW_APPL_SRV_RUNTIME~GET_EXPANDED_ENTITY`
```abap
" ZCL_ZGWHEADITEM_B03_DPC_EXT : /IWBEP/IF_MGW_APPL_SRV_RUNTIME~GET_EXPANDED_ENTITY

  method /IWBEP/IF_MGW_APPL_SRV_RUNTIME~GET_EXPANDED_ENTITY.
    TYPES BEGIN OF ty_headeritem.
      INCLUDE TYPE ZCL_ZGWHEADITEM_B03_MPC=>ts_header.
      TYPES ItemSet TYPE TABLE OF ZCL_ZGWHEADITEM_B03_MPC=>ts_item WITH DEFAULT KEY.
    TYPES END OF ty_headeritem.
    DATA: lv_carrid TYPE s_carr_id,
          ls_header_item TYPE ty_headeritem,
          lv_nav TYPE string VALUE 'ITEMSET'.

    LOOP AT it_key_tab INTO DATA(ls_key).
      IF ls_key-name EQ 'Carrid'.
        MOVE ls_key-value TO lv_carrid.
      ENDIF.
    ENDLOOP.

    " Header 조회
    SELECT SINGLE * FROM zscarrcl2_b03
      INTO CORRESPONDING FIELDS OF ls_header_item
      WHERE carrid = lv_carrid.
    if sy-subrc = 0.
      " Item 조회 (Navigation Property 이름에 맞춰 데이터 채움)
      SELECT * FROM zspflicl2_b03
        INTO CORRESPONDING FIELDS OF TABLE ls_header_item-itemset
        WHERE carrid = lv_carrid.
    ENDIF.

    " 결과 출력(ER_ENTITY)
    copy_data_to_ref(
      EXPORTING is_data = ls_header_item
      CHANGING cr_data = er_entity ).

    " Navigation Property 데이터 처리 완료되었다고 알려주는 파라미터
    INSERT lv_nav INTO TABLE et_expanded_tech_clauses.
  endmethod.
```
- `/IWBEP/IF_MGW_APPL_SRV_RUNTIME~GET_EXPANDED_ENTITYSET`
```abap
" ZCL_ZGWHEADITEM_B03_DPC_EXT : /IWBEP/IF_MGW_APPL_SRV_RUNTIME~GET_EXPANDED_ENTITYSET

  method /IWBEP/IF_MGW_APPL_SRV_RUNTIME~GET_EXPANDED_ENTITYSET.
    TYPES BEGIN OF ts_headeritem.
      INCLUDE TYPE ZCL_ZGWHEADITEM_B03_MPC=>ts_header.
      TYPES ItemSet TYPE TABLE OF ZCL_ZGWHEADITEM_B03_MPC=>ts_item WITH DEFAULT KEY.
    TYPES END OF ts_headeritem.

    TYPES tt_headeritem TYPE STANDARD TABLE OF
      ts_headeritem WITH DEFAULT KEY.

    DATA: lt_header_item_set TYPE tt_headeritem,
          lt_header_db TYPE TABLE OF ZSCARRCL2_B03,
          lt_item_db TYPE TABLE OF ZSPFLICL2_B03,
          lv_nav TYPE string VALUE 'ITEMSET'.
    FIELD-SYMBOLS <fs> TYPE ts_headeritem.

    " 1. Header 조회하고, Headeritem 구조체에 헤더 적용
    SELECT * FROM zscarrcl2_b03
      INTO TABLE lt_header_db.
    IF sy-subrc = 0.
      MOVE-CORRESPONDING lt_header_db TO lt_header_item_set.

      " 2-1. Header에 맞는 Item 조회
      SELECT * FROM zspflicl2_b03
        FOR ALL ENTRIES IN @lt_header_db
        WHERE carrid = @lt_header_db-carrid
        INTO TABLE @lt_item_db.

      " 2-2. Item 루프 돌면서, HeaderItem 구조체의 ItemSet테이블에 적용
      LOOP AT lt_item_db ASSIGNING FIELD-SYMBOL(<fs_item>).
        UNASSIGN <fs>.
        ASSIGN lt_header_item_set[ carrid = <fs_item>-carrid ] TO <fs>.
        APPEND <fs_item> TO <fs>-itemset.
      ENDLOOP.

      " 3. 결과 출력 (ER_ENTITYSET)
      copy_data_to_ref(
        EXPORTING is_data = lt_header_item_set
        CHANGING cr_data = er_entityset
      ).
      INSERT lv_nav INTO TABLE et_expanded_tech_clauses.
    ENDIF.
  endmethod.
```
- `/IWBEP/IF_MGW_APPL_SRV_RUNTIME~CREATE_DEEP_ENTITY`
```abap
" ZCL_ZGWHEADITEM_B03_DPC_EXT : /IWBEP/IF_MGW_APPL_SRV_RUNTIME~CREATE_DEEP_ENTITY

  method /IWBEP/IF_MGW_APPL_SRV_RUNTIME~CREATE_DEEP_ENTITY.
    TYPES BEGIN OF ts_headeritem.
      INCLUDE TYPE ZCL_ZGWHEADITEM_B03_MPC=>ts_header.
      TYPES ItemSet TYPE TABLE OF ZCL_ZGWHEADITEM_B03_MPC=>ts_item WITH DEFAULT KEY.
    TYPES END OF ts_headeritem.

    DATA: ls_create_data TYPE ts_headeritem,
          ls_header TYPE ZCL_ZGWHEADITEM_B03_mpc=>ts_header,
          lt_item TYPE ZCL_ZGWHEADITEM_B03_mpc=>tt_item.
    CASE iv_entity_name.
      WHEN 'Header'.
        io_data_provider->read_entry_data(
          IMPORTING es_data = ls_create_data
        ).

        " 받아온 Header-Item 데이터 분리
        MOVE-CORRESPONDING ls_create_data TO ls_header.
        MOVE-CORRESPONDING ls_create_data-itemset TO lt_item.

        " 각 DB Table에 Create
        INSERT zscarrcl2_b03 FROM ls_header.
        IF sy-subrc = 0.
          INSERT zspflicl2_b03 FROM TABLE lt_item.
          IF sy-subrc <> 0.
            ROLLBACK WORK.  " item insert 실패 시 전체 롤백
          ENDIF.
        ENDIF.

        " 결과 출력 (ER_DEEP_ENTITY)
        copy_data_to_ref(
          EXPORTING is_data = ls_create_data
          CHANGING cr_data = er_deep_entity
        ).
    ENDCASE.
  endmethod.
```
</br>
</br>

**2) Main.controller.js**
```java
// assignment1

sap.ui.define([
    "sap/ui/core/mvc/Controller",
    "sap/ui/model/Filter",
    "sap/ui/model/FilterOperator",
     "sap/ui/model/json/JSONModel",
     "sap/ui/core/Fragment"
], (Controller, Filter, FilterOperator, JSONModel, Fragment) => {
    "use strict";

    return Controller.extend("assignment1.controller.Main", {
        onInit() {
            this.oHeaderModel = this.getOwnerComponent().getModel("ZGWHEADITEM_B03_SRV");  
            this.oHeaderModel.read("/HeaderSet", {
                urlParameters: { "$expand": "ItemSet" },
                success: function(oReturn) {
                    sap.m.MessageToast.show("Header 전체 조회 성공!");
                    console.log(oReturn.results);
                    debugger;
                }.bind(this),
                error: function() { 
                    sap.m.MessageToast.show("Header 전체 조회 에러!");
                }
            })

            this.oInputModel = new JSONModel();
            this.oMainModel = new JSONModel();     
            this.getView().setModel(this.oInputModel, "oInputModel");   
            this.getView().setModel(this.oMainModel, "oMainModel");   
            this.oDataModel = this.getOwnerComponent().getModel();  
            this.oDataModel.read("/EmployeeSet", {
                success: function(oReturn) {
                    this.oMainModel.setData(oReturn.results);
                }.bind(this),
            })
        },
        onSearch: function() {
            let oInput = this.oInputModel.getData();    // 입력값 (필터)
            let oFilter = [];
            let oDateFormat = sap.ui.core.format.DateFormat.getInstance({
                pattern: "yyyy-MM-dd",
                UTC: true
            });
            let oStartDate = oDateFormat.parse(oInput.Assigndate);
            let oEndDate = oDateFormat.parse("20260701");

            if (oStartDate) {
                oFilter.push(
                    new Filter("Assigndate", FilterOperator.BT, oStartDate, oEndDate)
                );
            }
            if(oInput.Memo) {
                oFilter.push(new Filter("Memo", FilterOperator.EQ, oInput.Memo));
            }
            this.oDataModel.read("/EmployeeSet", {
                filters: oFilter,
                success: function(oReturn) {
                    this.oMainModel.setData(oReturn.results);
                    debugger;
                    sap.m.MessageToast.show("필터 성공!");
                }.bind(this),
                error: function() { 
                    sap.m.MessageToast.show("필터 에러!");
                }
            })
            // this.byId("idEmployeeTable").getBinding("items").filter(oFilter);
        },
        onCreate: function() {
            let oModel = new JSONModel();     
            let oDialog = sap.ui.getCore().byId("idCreateDialog");    

            if(oDialog) {      
                oDialog.open();
            }
            else {
                Fragment.load({
                    name: "assignment1.view.fragment.CreateDialog",        
                    type: "XML",        
                    controller: this    
                }).then(function(oDialog) {
                    oDialog.setModel(oModel, "oCreateModel");
                    oDialog.open();
                }.bind(this))
            }
        },
        onCreateButton: function() {
            let oData = sap.ui.getCore().byId("idCreateDialog").getModel("oCreateModel").getData();
            if (oData.Assigndate) {
                oData.Assigndate.setMinutes(
                    oData.Assigndate.getMinutes() - oData.Assigndate.getTimezoneOffset()
                );
            }
            let oBody = {
                Empno   : oData.Empno,
                Projod  : oData.Projod,
                Assigndate  : oData.Assigndate,
                Role    : oData.Role,
                Memo    : oData.Memo
            }
            this.oDataModel.create("/EmployeeSet", oBody, {
                success: function() {
                    sap.m.MessageToast.show("생성 성공!");
                },
                error: function() {
                    sap.m.MessageToast.show("생성 에러!");
                }
            })
            this.oDataModel.read("/EmployeeSet", {
                success: function(oReturn) {
                    this.oMainModel.setData(oReturn.results);
                }.bind(this)
            })
        },
        onClose2: function(oEvent) {
            oEvent.getSource().getParent().close();
        },
        onUpdate: function() {
            let oData = this.byId("idEmployeeTable").getSelectedItem().getBindingContext("oMainModel").getObject();    // 선택한 열의 데이터 가져오기
            let oModel = new JSONModel(oData);      // 선택한 열의 데이터로 모델 생성 -> 다이얼로그에서 쓰기 위함
            let oDialog = sap.ui.getCore().byId("idUpdateDialog");    

            if(oDialog) {      
                oDialog.open();
            }
            else {
                Fragment.load({
                    name: "assignment1.view.fragment.UpdateDialog",        
                    type: "XML",        
                    controller: this    
                }).then(function(oDialog) {
                    oDialog.setModel(oModel, "oUpdateModel");
                    oDialog.open();
                }.bind(this))
            }
        },
        onUpdateButton: function() {
            let oModel = sap.ui.getCore().byId("idUpdateDialog").getModel("oUpdateModel");    // 다이얼로그에서 수정한 데이터 값
            let oData = oModel.getData();

            oData.Assigndate.setMinutes(
                oData.Assigndate.getMinutes() - oData.Assigndate.getTimezoneOffset()
            );

            let sPath = this.oDataModel.createKey("/EmployeeSet", {
                Empno : oData.Empno,
                Projod : oData.Projod
            })
            this.oDataModel.update(sPath, oData, {
                success: function() {
                    sap.m.MessageToast.show("수정 성공!");
                    this.oDataModel.read("/EmployeeSet", {
                        success: function(oReturn) {
                            this.oMainModel.setData(oReturn.results);
                        }.bind(this)
                    })
                }.bind(this),
                error: function() {
                    sap.m.MessageToast.show("수정 에러!");
                }
            })
            this.oDataModel.read("/EmployeeSet", {
                success: function(oReturn) {
                    this.oMainModel.setData(oReturn.results);
                }.bind(this)
            })
        },
        onClose: function(oEvent) {
            oEvent.getSource().getParent().close();
        },
        onDelete: function() {
            let oData = this.byId("idEmployeeTable").getSelectedItem().getBindingContext("oMainModel").getObject(); 
            let sPath = this.oDataModel.createKey("/EmployeeSet", {
                Empno: oData.Empno,
                Projod : oData.Projod
            });
            this.oDataModel.remove(sPath, {
                success: function () {
                    sap.m.MessageToast.show("삭제 성공!");
                    this.oDataModel.read("/EmployeeSet", {
                        success: function(oReturn) {
                            this.oMainModel.setData(oReturn.results);
                        }.bind(this)
                    })
                }.bind(this)
            });
        }
    });
});
```
</br>
</br>

**3) Main.view.xml**
```html
// assignment1

<mvc:View controllerName="assignment1.controller.Main"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:f="sap.f"
    xmlns:layout="sap.ui.layout"
    xmlns:fb="sap.ui.comp.filterbar"
    xmlns="sap.m">
    <f:DynamicPage id="dynamicPageId" headerExpanded="true" toggleHeaderOnTitleClick="false">
        <!-- DynamicPage Title -->
        <f:title>
            <f:DynamicPageTitle>
                <f:heading>
                    <Title text="Header Title"/>
                </f:heading>
                <!-- <f:content>
                    <OverflowToolbar>
                    </OverflowToolbar>
                </f:content> -->
            </f:DynamicPageTitle>
        </f:title>
        <!-- DynamicPage Header -->
        <f:header>
            <f:DynamicPageHeader pinnable="false">
                <fb:FilterBar id="filterbar" search="onSearch" persistencyKey="myPersKey" useToolbar="false" showGoOnFB="true" showFilterConfiguration="false">
                    <fb:filterGroupItems>
                        <fb:FilterGroupItem name="Assigndate" groupName="Group1" label="Assign Date" visibleInFilterBar="true">
                            <fb:control>
                                <DatePicker value="{oInputModel>/Assigndate}"
                                            valueFormat="yyyy-MM-dd"
                                            displayFormat="yyyy-MM-dd" />
                            </fb:control>
                        </fb:FilterGroupItem>
                        <fb:FilterGroupItem name="Memo" groupName="Group1" label="Memo" visibleInFilterBar="true">
                            <fb:control>
                                <Input value="{oInputModel>/Memo}"/>
                            </fb:control>
                        </fb:FilterGroupItem>
                        <!-- <fb:FilterGroupItem name="Search" groupName="Group1" visibleInFilterBar="true">
                            <fb:control>
                                <Button text="검색버튼" press="onPress" />
                            </fb:control>
                        </fb:FilterGroupItem> -->
                    </fb:filterGroupItems>
                </fb:FilterBar>
            </f:DynamicPageHeader>
        </f:header>
        <f:content>
            <Table id="idEmployeeTable"
                    sticky="HeaderToolbar,ColumnHeaders"
                    inset="false"
                    items="{oMainModel>/}"
                    selectionChange="onSelectionChange"
                    class="sapFDynamicPageAlignContent"
                    mode="SingleSelectLeft"
                    width="auto">
                <headerToolbar>
                    <Toolbar>
                        <Title text="Products" level="H2"/>
                        <Button text="생성" press="onCreate" type="Emphasized"/>
                        <Button text="수정" press="onUpdate" type="Emphasized"/>
                        <Button text="삭제" press="onDelete" type="Emphasized"/>
                    </Toolbar>
                </headerToolbar>
                <columns>
                    <Column width="12em">
                        <Text text="Empno" />
                    </Column>
                    <Column width="12em">
                        <Text text="Projod" />
                    </Column>
                    <Column width="12em">
                        <Text text="Assigndate" />
                    </Column>
                    <Column width="12em">
                        <Text text="Role" />
                    </Column>
                    <Column width="12em">
                        <Text text="Memo" />
                    </Column>
                </columns>
                <items>
                    <ColumnListItem>
                        <cells>
                            <Text text="{oMainModel>Empno}" />
                            <Text text="{oMainModel>Projod}" />
                            <Text text="{
                                path: 'oMainModel>Assigndate',
                                type: 'sap.ui.model.type.DateTime',
                                formatOptions: { pattern : 'yyyy-MM-dd' }
                            }" />
                            <Text text="{oMainModel>Role}" />
                            <Text text="{oMainModel>Memo}" />
                        </cells>
                    </ColumnListItem>
                </items>
            </Table>
        </f:content>
    </f:DynamicPage>
</mvc:View>
```
</br>
</br>

**4) CreateDialog.fragment.xml**
```html
// assignment1

<c:FragmentDefinition 
    xmlns="sap.m" 
    xmlns:f="sap.ui.layout.form"
    xmlns:c="sap.ui.core">
    <Dialog id="idCreateDialog"
            title="Create Dialog"
            contentHeight="50%"
            contentWidth="20%">
        <content>
            <f:SimpleForm
                layout="ColumnLayout"
                columnsXL="1"
                columnsL="1"
                columnsM="1">
                <f:content>
                    <Label text="Empno"/>
                    <Input value="{oCreateModel>/Empno}" />
                    <Label text="Projod"/>
                    <Input value="{oCreateModel>/Projod}" />
                    <Label text="Assign date"/>
                    <DatePicker
                        dateValue="{oCreateModel>/Assigndate}"
                        displayFormat="yyyy-MM-dd"
                    />
                    <Label text="Role"/>
                    <Input value="{oCreateModel>/Role}" />
                    <Label text="Memo"/>
                    <Input value="{oCreateModel>/Memo}" />
                </f:content>
            </f:SimpleForm>
        </content>
        <buttons>
            <Button text="생성" press=".onCreateButton" />
            <Button text="닫기" press=".onClose2" />
        </buttons>
    </Dialog>
</c:FragmentDefinition>
```
</br>
</br>

**5) UpdateDialog.fragment.xml**
```html
// assignment1

<c:FragmentDefinition 
    xmlns="sap.m" 
    xmlns:f="sap.ui.layout.form"
    xmlns:c="sap.ui.core">
    <Dialog id="idUpdateDialog"
            title="Update Dialog"
            contentHeight="50%"
            contentWidth="20%">
        <content>
            <f:SimpleForm
                layout="ColumnLayout"
                columnsXL="1"
                columnsL="1"
                columnsM="1">
                <f:content>
                    <Label text="Empno"/>
                    <Input value="{oUpdateModel>/Empno}" />
                    <Label text="Projod"/>
                    <Input value="{oUpdateModel>/Projod}" />
                    <Label text="Assign date"/>
                    <DatePicker
                        dateValue="{oUpdateModel>/Assigndate}"
                        displayFormat="yyyy-MM-dd"
                    />
                    <Label text="Role"/>
                    <Input value="{oUpdateModel>/Role}" />
                    <Label text="Memo"/>
                    <Input value="{oUpdateModel>/Memo}" />
                </f:content>
            </f:SimpleForm>
        </content>
        <buttons>
            <Button text="수정" press=".onUpdateButton" />
            <Button text="닫기" press=".onClose" />
        </buttons>
    </Dialog>
</c:FragmentDefinition>
```
</br>
</br>
</br>
</br>
</br>

### 실습 2
- Header-Item Create 구현 실습
<img width="425" height="265" alt="image" src="https://github.com/user-attachments/assets/69c3337a-1582-45a4-a178-cc74e1ccedb4" />
</br>

<img width="549" height="305" alt="image" src="https://github.com/user-attachments/assets/baf59017-1d98-4a60-9ffc-11002129e7a2" />
</br>

<img width="556" height="356" alt="image" src="https://github.com/user-attachments/assets/9c72afb2-91c0-45b9-b4c3-4d7b4f20e7de" />

</br>
</br>
</br>

**1) SAP GUI 코드**
- `HEADERSET_GET_ENTITYSET`
```abap
" ZCL_ZGWHEADITEM_B03_DPC_EXT : HEADERSET_GET_ENTITYSET

  method HEADERSET_GET_ENTITYSET.
    SELECT * FROM zscarrcl2_b03
      INTO TABLE et_entityset.
  endmethod.
```
- `ITEMSET_GET_ENTITYSET`
```abap
" ZCL_ZGWHEADITEM_B03_DPC_EXT : ITEMSET_GET_ENTITYSET

  method ITEMSET_GET_ENTITYSET.
    DATA lv_carrid TYPE s_carr_id.
    DATA lt_data TYPE TABLE OF zspflicl2_b03.

    LOOP AT it_key_tab INTO DATA(ls_key).
      IF ls_key-name EQ 'Carrid'.
        MOVE ls_key-value TO lv_carrid.
      ENDIF.
    ENDLOOP.

    SELECT * FROM ZSPFLICL2_B03
      INTO TABLE lt_data
      WHERE carrid = lv_carrid.
    IF sy-subrc = 0.
      MOVE-CORRESPONDING lt_data TO et_entityset.
    ENDIF.
  endmethod.
```
- `/IWBEP/IF_MGW_APPL_SRV_RUNTIME~GET_EXPANDED_ENTITY`
```abap
" ZCL_ZGWHEADITEM_B03_DPC_EXT : /IWBEP/IF_MGW_APPL_SRV_RUNTIME~GET_EXPANDED_ENTITY

  method /IWBEP/IF_MGW_APPL_SRV_RUNTIME~GET_EXPANDED_ENTITY.
    TYPES BEGIN OF ty_headeritem.
      INCLUDE TYPE ZCL_ZGWHEADITEM_B03_MPC=>ts_header.
      TYPES ItemSet TYPE TABLE OF ZCL_ZGWHEADITEM_B03_MPC=>ts_item WITH DEFAULT KEY.
    TYPES END OF ty_headeritem.
    DATA: lv_carrid TYPE s_carr_id,
          ls_header_item TYPE ty_headeritem,
          lv_nav TYPE string VALUE 'ITEMSET'.

    LOOP AT it_key_tab INTO DATA(ls_key).
      IF ls_key-name EQ 'Carrid'.
        MOVE ls_key-value TO lv_carrid.
      ENDIF.
    ENDLOOP.

    " Header 조회
    SELECT SINGLE * FROM zscarrcl2_b03
      INTO CORRESPONDING FIELDS OF ls_header_item
      WHERE carrid = lv_carrid.
    if sy-subrc = 0.
      " Item 조회 (Navigation Property 이름에 맞춰 데이터 채움)
      SELECT * FROM zspflicl2_b03
        INTO CORRESPONDING FIELDS OF TABLE ls_header_item-itemset
        WHERE carrid = lv_carrid.
    ENDIF.

    " 결과 출력(ER_ENTITY)
    copy_data_to_ref(
      EXPORTING is_data = ls_header_item
      CHANGING cr_data = er_entity ).

    " Navigation Property 데이터 처리 완료되었다고 알려주는 파라미터
    INSERT lv_nav INTO TABLE et_expanded_tech_clauses.
  endmethod.
```
- `/IWBEP/IF_MGW_APPL_SRV_RUNTIME~GET_EXPANDED_ENTITYSET`
```abap
" ZCL_ZGWHEADITEM_B03_DPC_EXT : /IWBEP/IF_MGW_APPL_SRV_RUNTIME~GET_EXPANDED_ENTITYSET

  method /IWBEP/IF_MGW_APPL_SRV_RUNTIME~GET_EXPANDED_ENTITYSET.
    TYPES BEGIN OF ts_headeritem.
      INCLUDE TYPE ZCL_ZGWHEADITEM_B03_MPC=>ts_header.
      TYPES ItemSet TYPE TABLE OF ZCL_ZGWHEADITEM_B03_MPC=>ts_item WITH DEFAULT KEY.
    TYPES END OF ts_headeritem.

    TYPES tt_headeritem TYPE STANDARD TABLE OF
      ts_headeritem WITH DEFAULT KEY.

    DATA: lt_header_item_set TYPE tt_headeritem,
          lt_header_db TYPE TABLE OF ZSCARRCL2_B03,
          lt_item_db TYPE TABLE OF ZSPFLICL2_B03,
          lv_nav TYPE string VALUE 'ITEMSET'.
    FIELD-SYMBOLS <fs> TYPE ts_headeritem.

    " 1. Header 조회하고, Headeritem 구조체에 헤더 적용
    SELECT * FROM zscarrcl2_b03
      INTO TABLE lt_header_db.
    IF sy-subrc = 0.
      MOVE-CORRESPONDING lt_header_db TO lt_header_item_set.

      " 2-1. Header에 맞는 Item 조회
      SELECT * FROM zspflicl2_b03
        FOR ALL ENTRIES IN @lt_header_db
        WHERE carrid = @lt_header_db-carrid
        INTO TABLE @lt_item_db.

      " 2-2. Item 루프 돌면서, HeaderItem 구조체의 ItemSet테이블에 적용
      LOOP AT lt_item_db ASSIGNING FIELD-SYMBOL(<fs_item>).
        UNASSIGN <fs>.
        ASSIGN lt_header_item_set[ carrid = <fs_item>-carrid ] TO <fs>.
        APPEND <fs_item> TO <fs>-itemset.
      ENDLOOP.

      " 3. 결과 출력 (ER_ENTITYSET)
      copy_data_to_ref(
        EXPORTING is_data = lt_header_item_set
        CHANGING cr_data = er_entityset
      ).
      INSERT lv_nav INTO TABLE et_expanded_tech_clauses.
    ENDIF.
  endmethod.
```
- `/IWBEP/IF_MGW_APPL_SRV_RUNTIME~CREATE_DEEP_ENTITY`
```abap
" ZCL_ZGWHEADITEM_B03_DPC_EXT : /IWBEP/IF_MGW_APPL_SRV_RUNTIME~CREATE_DEEP_ENTITY

  method /IWBEP/IF_MGW_APPL_SRV_RUNTIME~CREATE_DEEP_ENTITY.
    TYPES BEGIN OF ts_headeritem.
      INCLUDE TYPE ZCL_ZGWHEADITEM_B03_MPC=>ts_header.
      TYPES ItemSet TYPE TABLE OF ZCL_ZGWHEADITEM_B03_MPC=>ts_item WITH DEFAULT KEY.
    TYPES END OF ts_headeritem.

    DATA: ls_create_data TYPE ts_headeritem,
          ls_header TYPE ZCL_ZGWHEADITEM_B03_mpc=>ts_header,
          lt_item TYPE ZCL_ZGWHEADITEM_B03_mpc=>tt_item.
    CASE iv_entity_name.
      WHEN 'Header'.
        io_data_provider->read_entry_data(
          IMPORTING es_data = ls_create_data
        ).

        " 받아온 Header-Item 데이터 분리
        MOVE-CORRESPONDING ls_create_data TO ls_header.
        MOVE-CORRESPONDING ls_create_data-itemset TO lt_item.

        " 각 DB Table에 Create
        INSERT zscarrcl2_b03 FROM ls_header.
        IF sy-subrc = 0.
          INSERT zspflicl2_b03 FROM TABLE lt_item.
          IF sy-subrc <> 0.
            ROLLBACK WORK.  " item insert 실패 시 전체 롤백
          ENDIF.
        ENDIF.

        " 결과 출력 (ER_DEEP_ENTITY)
        copy_data_to_ref(
          EXPORTING is_data = ls_create_data
          CHANGING cr_data = er_deep_entity
        ).
    ENDCASE.
  endmethod.
```
</br>
</br>

**2) Main.controller.js**
```java
// assignment2

sap.ui.define([
    "sap/ui/core/mvc/Controller",
    "sap/ui/model/json/JSONModel",
    "sap/ui/core/Fragment",
    "sap/ui/model/Sorter"
], (Controller, JSONModel, Fragment, Sorter) => {
    "use strict";

    return Controller.extend("assignment2.controller.Main", {
        onInit() {
            this.oHeaderModel = this.getOwnerComponent().getModel();  
            // this.oHeaderModel.read("/HeaderSet", {
            //     urlParameters: {
            //         "$expand" : "ItemSet",
            //     },
            //     success: function() {
            //         sap.m.MessageToast.show("Header 조회 성공!");
            //     },
            //     error: function() {
            //         sap.m.MessageToast.show("Header 조회 실패!");
            //     }
            // })
            this.oItemNodel = this.getOwnerComponent().getModel();  
        },
        onSelectionChange: function(oEvent) {
            let sPath = oEvent.getParameters().listItem.getBindingContext().getPath();
            this.byId("idItemTable").bindElement(sPath);
        },
        onCreate: function() {
            let oData = {
                Carrid : "",
                Carrname : "",
                Currcode : "",
                ItemSet: [ {
                    Carrid : "",
                    Connid : "",
                    Cityfrom : "",
                    Airpfrom : "",
                    Cityto : "",
                    Airpto : ""
                } ]
            };
            let oModel = new JSONModel(oData); 
            let oDialog = sap.ui.getCore().byId("idCreateDialog");    

            if(oDialog) {      
                this._oDialog.open();
            }
            else {
                Fragment.load({
                    name: "assignment2.view.fragment.CreateDialog",        
                    type: "XML",        
                    controller: this    
                }).then(function(oDialog) {
                    this._oDialog = oDialog;
                    this._oDialog.setModel(oModel, "oCreateModel");
                    this._oDialog.open();
                }.bind(this))
            }
        },
        onAddLine: function() {
            let oModel = this._oDialog.getModel("oCreateModel");
            let oData = oModel.getProperty("/ItemSet");
            oData.push({
                Carrid : "",
                Connid : "",
                Cityfrom : "",
                Airpfrom : "",
                Cityto : "",
                Airpto : ""
            });
            oModel.setProperty("/ItemSet", oData);
        },
        onCreateSave: function() {
            let oData = this._oDialog.getModel("oCreateModel").getData();
            let oItems = [];
            for (let i=0; i<oData.ItemSet.length; i++) {
                let oInputRow = oData.ItemSet[i]; 
                oItems.push({
                    Carrid   : oData.Carrid,      
                    Connid   : oInputRow.Connid,
                    Cityfrom : oInputRow.Cityfrom,
                    Airpfrom : oInputRow.Airpfrom,
                    Cityto   : oInputRow.Cityto,
                    Airpto   : oInputRow.Airpto
                });
            }
            let oBody = {
                Carrid : oData.Carrid,
                Carrname : oData.Carrname,
                Currcode : oData.Currcode,
                ItemSet: oItems
            };
            this.oHeaderModel.create("/HeaderSet", oBody, {
                success: function() {
                    sap.m.MessageToast.show("생성 성공!");
                    this._oDialog.close();
                }.bind(this),
                error: function() {
                    sap.m.MessageToast.show("생성 실패!");
                }
            });
        },
        onCreateClose: function(oEvent) {
            oEvent.getSource().getParent().close();
        }
    });
});
```
</br>
</br>

**3) Main.view.xml**
```html
// assignment2

<mvc:View controllerName="assignment2.controller.Main"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m">
    <Page id="page" title="{i18n>title}">
        <Table id="idHeaderTable"
                sticky="HeaderToolbar,ColumnHeaders"
                inset="false"
                items="{/HeaderSet}"
                selectionChange="onSelectionChange"
                class="sapFDynamicPageAlignContent"
                mode="SingleSelectLeft"
                width="auto"
                updateFinished="onHeaderUpdateFinished">
            <headerToolbar>
                <Toolbar>
                    <Title text="Header Table" level="H2" />
                    <Button text="생성" press="onCreate" />
                    <Button text="수정" press="onUpdate" />
                    <Button text="삭제" press="onDelete" />
                </Toolbar>
            </headerToolbar>
            <columns>
                <Column width="12em">
                    <Text text="Carrid" />
                </Column>
                <Column width="12em">
                    <Text text="Carrname" />
                </Column>
                <Column width="12em">
                    <Text text="Currcode" />
                </Column>
            </columns>
            <items>
                <ColumnListItem>
                    <cells>
                        <Text text="{Carrid}" />
                        <Text text="{Carrname}" />
                        <Text text="{Currcode}" />
                    </cells>
                </ColumnListItem>
            </items>
        </Table>
        <Toolbar class="sapUiMediumMarginTop" visible="false"/>
        <Table id="idItemTable"
                visible="true"
                sticky="HeaderToolbar,ColumnHeaders"
                inset="false"
                items="{ItemSet}"
                class="sapFDynamicPageAlignContent"
                width="auto">
            <headerToolbar>
                <Toolbar>
                    <Title text="Item Table" level="H2" />
                </Toolbar>
            </headerToolbar>
            <columns>
                <Column width="12em">
                    <Text text="Carrid" />
                </Column>
                <Column width="12em">
                    <Text text="Connid" />
                </Column>
                <Column width="12em">
                    <Text text="Cityfrom" />
                </Column>
                <Column width="12em">
                    <Text text="Airpfrom" />
                </Column>
                <Column width="12em">
                    <Text text="Cityto" />
                </Column>
                <Column width="12em">
                    <Text text="Airpto" />
                </Column>
            </columns>
            <items>
                <ColumnListItem>
                    <cells>
                        <Text text="{Carrid}" />
                        <Text text="{Connid}" />
                        <Text text="{Cityfrom}" />
                        <Text text="{Airpfrom}" />
                        <Text text="{Cityto}" />
                        <Text text="{Airpto}" />
                    </cells>
                </ColumnListItem>
            </items>
        </Table>
    </Page>
</mvc:View>
```
</br>
</br>

**4) CreateDialog.fragment.xml**
```html
" assignment2

<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:f="sap.ui.layout.form">
    <Dialog id="idCreateDialog" title="데이터 생성" contentWidth="600px">
        <content>
            <f:SimpleForm editable="true">
                <f:content>
                    <core:Title text="Header Create" />
                    <Label text="Carrid" />
                    <Input value="{oCreateModel>/Carrid}" maxLength="3"/>
                    <Label text="Carrname" />
                    <Input value="{oCreateModel>/Carrname}" />
                    <Label text="Currcode" />
                    <Input value="{oCreateModel>/Currcode}" />
                </f:content>
            </f:SimpleForm>

            <Table items="{oCreateModel>/ItemSet}">
                <headerToolbar>
                    <OverflowToolbar>
                        <Title text="Item Create" />
                        <ToolbarSpacer />
                        <Button icon="sap-icon://add" text="행 추가" press="onAddLine" />
                    </OverflowToolbar>
                </headerToolbar>
                <columns>
                    <Column><Text text="Connid" /></Column>
                    <Column><Text text="Cityfrom" /></Column>
                    <Column><Text text="Airpfrom" /></Column>
                    <Column><Text text="Cityto" /></Column>
                    <Column><Text text="Airpto" /></Column>
                </columns>
                <items>
                    <ColumnListItem>
                        <cells>
                            <Input value="{oCreateModel>Connid}" />
                            <Input value="{oCreateModel>Cityfrom}" />
                            <Input value="{oCreateModel>Airpfrom}" />
                            <Input value="{oCreateModel>Cityto}" />
                            <Input value="{oCreateModel>Airpto}" />
                        </cells>
                    </ColumnListItem>
                </items>
            </Table>
        </content>
        <beginButton>
            <Button text="생성" type="Emphasized" press="onCreateSave" />
        </beginButton>
        <endButton>
            <Button text="닫기" press="onCreateClose" />
        </endButton>
    </Dialog>
</core:FragmentDefinition>
```
