## <  핵심 개념 >
- **1) `read()` 로 `GET_ENTITY` 호출 시, 문자 타입 키는 반드시 ' '로 감싸야 함**
```java
this.oModel.read(`/EmployeeSet(Empno='${oData.Empno}',Projod='${oData.Projod}')`, ...)
```

- **2) `sap.ui.table.Table` 정리**

| 구분 | 의미 | XML에서 쓰는 방식 | 예시 |
|---|---|---|---|
| Properties | 값 설정 | 속성 | selectionMode="Single" |
| Aggregations | 자식 컨트롤 | 태그 | <t:columns> |
| Associations | ID 연결 | 속성(ID) | ariaLabelledBy="titleId" |
| Events | 이벤트 핸들러 | 속성 | rowSelectionChange="onSelect" |
| Methods | 함수 | JS에서만 사용 | getSelectedIndex() |

- **3) `m.Table` → 모바일·단순 조회용 List 기반 테이블, `ui.table.Table` → 데스크탑·대량 데이터용 ALV 스타일 Grid 테이블**
</br>
</br>

---

</br>

## < FIORI 함수 >
</br>

### 1) 컨트롤러 한정 전역 변수
- 해당 컨트롤러 내부에서는 전역처럼 사용
- 다른 컨트롤러에서는 접근 불가
```java
this._oPersonModel = this.getOwnerComponent().getModel();
```
</br>
</br>

### 2) OData 단건 조회 (EntitySet Read)
- 키가 1개면 필드명 생략 가능 → `/EntitySet('값')`
- 키가 여러 개면 키 이름 필수 → `/EntitySet(key1='값', key2='값')`
```java
// /EntitySet('KeyValue') → 단건
this._oPersonModel.read("/PersonSet('9001')", {
    success: function (oReturn) {
        // oReturn = 단일 Entity
        // oReturn.FieldName 형태로 바로 접근
        debugger;
    }.bind(this),
    error: function (oError) {
        console.log("Read EntitySet 에러!", oError);
    }
});

// /EntitySet → 다건
this._oPersonModel.read("/PersonSet", {
    success: function (oReturn) {
        // oReturn.results = Entity 배열
        // oReturn.results[0].FieldName 형태로 접근
        debugger;
    }.bind(this),
    error: function (oError) {
        console.log("Read EntitySet 에러!", oError);
    }
});
```

</br>
</br>

---

</br>

## < SAP Gateway OData 서비스 생성·활성·테스트 흐름 (TCODE: `SEGW`) >
- SEGW에서 OData 설계 → MAINT_SERVICE에서 서비스 활성화 → GW_CLIENT에서 URL 테스트
<img width="315" height="175" alt="image" src="https://github.com/user-attachments/assets/dc8325ac-9057-42a3-bd43-9c3f032c3045" />
</br>
</br>
</br>
</br>
</br>

### 1) OData 연동을 위한 DB 테이블 정의
- OData 서비스에서 사용할 사원 정보 테이블(ZTEMPINFO_B03)을 생성하고 필드와 Key를 정의

<img width="513" height="225" alt="image" src="https://github.com/user-attachments/assets/5b3705b3-7aa1-4484-bfb3-95a05db69d8e" />
</br>
</br>
</br>

### 2) `SEGW` 에서 OData 프로젝트 생성
- SAP Gateway Service Builder(SEGW)에서 Employee OData 서비스를 위한 프로젝트를 생성
  
<img width="356" height="116" alt="image" src="https://github.com/user-attachments/assets/5390dc8b-e248-4d13-b958-82e492b1e51c" />

<img width="428" height="256" alt="image" src="https://github.com/user-attachments/assets/b3736899-0229-402e-a84e-e2372d021a7b" />
</br>
</br>
</br>

### 3) DB 테이블 기반 Entity 생성
- SEGW에서 DDIC 테이블(ZTEMPINFO_B03)을 Import하여 Employee Entity와 EntitySet을 생성

<img width="375" height="251" alt="image" src="https://github.com/user-attachments/assets/216e5112-5bf7-45a4-a78c-399dd9f8d8ff" />

<img width="433" height="268" alt="image" src="https://github.com/user-attachments/assets/316f999a-9060-4eb2-bfd9-89a30ee88b7a" />

</br>
</br>
</br>

### 4) Entity 필드 속성 및 Key 설정
- Employee Entity의 필드 타입을 확인하고 Primary Key를 지정하며, Nullable 옵션으로 해당 필드의 필수 입력 여부(NULL 허용/불가)를 설정
  
<img width="590" height="256" alt="image" src="https://github.com/user-attachments/assets/a4cee978-4e20-4308-bcf9-134187c31be8" />
</br>
</br>
</br>

### 5) Runtime Artifacts 생성 및 변경사항 반영
- Generate 버튼을 눌러 Data Model 변경 내용을 기준으로 Runtime Artifacts(MPC/DPC)를 생성
- 구조나 설정이 변경되면 반드시 다시 Generate 버튼을 눌러야 변경사항이 반영됨
  
<img width="409" height="161" alt="image" src="https://github.com/user-attachments/assets/44019cff-dc54-4d1c-a9cf-672bf28de402" />

<img width="433" height="238" alt="image" src="https://github.com/user-attachments/assets/806f86c5-056b-4565-bea0-5b950f82c6f2" />
</br>
</br>
</br>

### 6) OData 서비스 등록 및 활성화
- SEGW에서 생성한 OData 서비스를 Gateway 시스템에 등록(Register)하여 외부에서 호출 가능하게 활성화

<img width="508" height="201" alt="image" src="https://github.com/user-attachments/assets/7bf7fa93-0778-4f27-9f57-0115ceb1f953" />

<img width="675" height="469" alt="image" src="https://github.com/user-attachments/assets/40404773-edfa-4fcc-afd3-001fc8f32935" />

</br>
</br>
</br>
</br>

### 7) Gateway 서비스 관리 및 활성화 확인
- /IWFND/MAINT_SERVICE에서 등록된 OData 서비스를 조회하고 활성화 상태, System Alias, ICF 노드를 관리
  
<img width="586" height="472" alt="image" src="https://github.com/user-attachments/assets/9727bf15-2d8c-4259-90e0-c9369d4dc73e" />
</br>
</br>
</br>

### 8) SAP Gateway Client를 통한 OData 서비스 테스트
- `SEGW` 또는 `/IWFND/GW_CLIENT` 에서 OData 서비스 URL을 실행하여 EntitySet 조회 및 응답 데이터를 테스트

<img width="638" height="299" alt="image" src="https://github.com/user-attachments/assets/77b3e903-f2cb-457d-b72d-2fddb014316d" />

<img width="651" height="387" alt="image" src="https://github.com/user-attachments/assets/008dbaf0-6f99-4b6b-9c37-79fcc4bd9392" />
</br>
</br>
</br>

### 9) SAP Gateway Client에서 CRUD 테스트
- GET/POST/PUT/DELETE 방식으로 Read·Create·Update·Delete 동작을 테스트
- 200번대 응답은 성공이며, 오류 발생 시 결과가 빨간색으로 표시됨
- POST 요청은 Body에 데이터를 담아 전송하여 데이터 생성 수행

<img width="626" height="384" alt="image" src="https://github.com/user-attachments/assets/61f6c753-907f-4fe0-b19f-fabb9650955f" />
</br>
</br>
</br>



</br>
</br>
</br>
</br>

---

</br>

## < 실습 코드 >
</br>

### 실습 1
- read로 조회 후 input에 세팅하는 실습
<img width="474" height="244" alt="image" src="https://github.com/user-attachments/assets/431bc215-12b6-4521-9727-450b4d7a01f0" />

</br>
</br>
</br>

### 1) Main.view.xml
```html
// test 프로그램
<Button text="EntitySet" press="onReadEntitySet" />
```
</br>

### 2) Main.controller.js
```java
// test 프로그램

sap.ui.define([
    "sap/ui/core/mvc/Controller",
    "sap/ui/model/json/JSONModel"   // 사용할 라이브러리 추가
], (Controller, JSONModel) => {
    "use strict";

    return Controller.extend("test1.controller.Main", {
        onInit() {
            this._oPersonModel = this.getOwnerComponent().getModel("ZCODE_PERSON2_SRV");
        },
        onReadEntitySet: function() {
            // this._oPersonModel => oData V2 Model
            let oModel = this.getView().getModel("view");
    
            this._oPersonModel.read("/PersonSet('9001')", {
                success: function(oReturn) {
                    // Request 요청이 성공하면, succcess 함수가 실행됨
                    // console.log("Read EntitySet 성공!", oReturn);
                    // oModel.setProperty("/salary", oReturn.results[0].Memo);
                    oModel.setProperty("/name/FirstName", oReturn.Firstname);
                    oModel.setProperty("/name/LastName", oReturn.Lastname);
                    debugger;
                }.bind(this),
                error: function(oError) {
                    console.log("Read EntitySet 에러!", oError);
                }
            })
        }
    });
});
```
</br>
</br>

---

</br>

## < 실습 코드 >
</br>

### 실습 1
- 테이블 중 한 행 선택하면 해당 행 정보 띄우기
- m.table ui.table 실습

<img width="444" height="200" alt="image" src="https://github.com/user-attachments/assets/6c8d6864-1c28-4b19-a2c6-b20fb0bb814c" />
