# 10/28 기록
### SAPUI5 Model 정리
- Model: 데이터를 관리해주는 역할
- 클라이언트(Client) 모델
  - 종류: JSON, XML, Resource
  - 특징: 프로젝트 내부에서만 사용, 서버 요청 없음 → 바로 화면에 사용 가능 (데이터가 이미 로컬에 있음)
- 서버(Server) 모델
  - 종류: OData V2, OData V4
  - 특징: 서버와 통신, 서버에 요청 필요 → 서버 응답 받아 화면에 사용
</br>

### SAPUI5 JSONModel 사용 정리
- `getModel`
  - View 또는 컨트롤러에서 등록된 모델을 가져오는 함수
  - 가져온 모델 객체를 통해 데이터 조회/수정 가능
```java
var oModel = View.getModel(sName)
```
</br>

- `setModel`
  - 모델을 View 또는 컨트롤러에 연결하는 역할
  - 연결된 모델은 화면(UI) 요소와 바인딩 가능
```java
View.setModel(oModel, sName)
```
</br>

- 모듈 정의 및 불러오기
```java
sap.ui.define([
    "sap/ui/core/mvc/Controller",
    "sap/ui/model/json/JSONModel"
], function(Controller, JSONModel) {
    "use strict";
});
```
</br>

- 컨트롤러에서 생성한 모델
- 다른 View에서는 접근 불가 → 컨트롤러/해당 View 내부에서만 사용 가능 (local(지역) 모델)
- `setModel(oModel, "customer")` → View에서 "customer"라는 이름으로 접근
- `setModel(oModel)` → 기본 모델, 이름 없이 접근 가능
```java
onInit: function() {
    // 1. JSONModel 생성
    var oModel = new sap.ui.model.json.JSONModel({
        name: "홍길동",
        age: 30
    });

    // 2. 현재 View에 모델 연결 (컨트롤러 전용)
    this.getView().setModel(oModel, "customer");
}
```
</br>

- manifest.json에서 정의한 모델
- manifest.json에서 정의 → 앱 전체에서 전역 모델(Global Model)
- `this.getView().getModel()` → 기본 모델(""). 이름 없이 접근 가능. 
- `this.getView().getModel("customer")` →  이름 있는 모델. "customer" 같은 이름으로 접근.
```java
{
  "sap.ui5": {
    "models": {
      "": { // 기본 모델
        "type": "sap.ui.model.json.JSONModel",
        "settings": {
          "data": { "name": "홍길동", "age": 30 }
        }
      },
      "customer": { // 이름 있는 전역 모델
        "type": "sap.ui.model.json.JSONModel",
        "settings": {}
      }
    }
  }
}
```
</br>

### 바인딩(Binding)
- 모델(Model)과 화면(View)을 연결하여 데이터를 자동으로 표시하고 동기화하는 기능
</br>

### 바인딩 방식(mode)
- one-time : 모델 → 뷰, 일회성 바인딩(최초 1회만 화면에 표시)
- one-way : 모델 → 뷰, 단방향 바인딩(모델 데이터 변경 시 화면 자동 갱신)
- two-way : 모델 ↔ 뷰, 양방향 바인딩(모델과 화면 모두 동기화, 뷰 변경 시 모델에도 반영)
</br>

### 모델 종류
- JSON Model: 클라이언트 데이터(JSON) 관리, 기본 two-way
- XML Model: 클라이언트 XML 데이터 관리, 기본 two-way
- Resource Model: 다국어(i18n) 문자열 관리, 기본 one-way
- OData V2 Model: 서버 데이터 통신, 기본 one-way
- OData V4 Model: 최신 서버 데이터 통신, 기본 one-way
</br>

### SAPUI5 JSON Model 바인딩 접근
- 컨트롤러에서 생성한 모델 (Local Model)
```java
onInit() {
    // 객체 데이터
    let oData = { 
        inputValue: {
            firstName: "Park",
            lastName: "Gildong"
        }
    };

    // 배열 데이터
    let aData = { 
        inputValue: [{
            firstName: "Park",
            lastName: "Gildong"
        }]
    };

    // JSONModel 생성
    let oModel = new JSONModel(oData);
    let aModel = new JSONModel(aData);
    let nModel = new JSONModel(oData);

    // View에 모델 연결
    this.getView().setModel(oModel, "local");
    this.getView().setModel(aModel, "array");
    this.getView().setModel(nModel);
}
```
</br>
</br>


- 배열 데이터 접근
```html
<Page id="page" title="{array>/inputValue/0/firstName}">
    <!-- array의 name 배열 첫 번째 객체(인덱스 0번)의 firstName -->
</Page>
```
- 객체 데이터 접근
```html
<Page id="page" title="{local>/inputValue/firstName}">
    <!-- local의 firstName -->
</Page>
```
- 단일 속성 바인딩
```html
<Page id="page" title="{/inputValue/firstName}">
    <!-- 기본 모델의 inputValue.firstName -->
</Page>
```
- 다중 속성 바인딩
```html
<Page id="page" title="{local>/inputValue/firstName} {local>/inputValue/lastName}">
    <!-- local 모델의 name 객체 속성 firstName과 lastName 바인딩 -->
</Page>
```
</br>

### Property Binding
- 단일 데이터 값을 UI 컨트롤에 연결하는 방식
- 예시: `{과일들: [{이름: 사과, 가격: 5000}]}`
- 접근: `/과일들/0/이름` → "사과", `/과일들/0/가격` → 5000
- 특징: 단순, 하나의 컨트롤에 하나의 데이터 필드 연결

### Aggregation Binding (List / Table Binding)
- 컬렉션(배열)을 UI 컨트롤(리스트, 테이블 등)에 연결
- 접근: `/과일들` → 전체 배열 바인딩
- 각 아이템 접근: `/과일들/0/이름`, `/과일들/0/가격`
- 특징: 반복 UI 요소 자동 생성 가능 (ex. 테이블 row)
</br>
</br>

### Table Aggregation Binding (sap.m.Table) 예제 
- `sap.m.Table`은 `items`
- `items="{모델명>/경로}"` → 배열 전체를 바인딩 (반복 구조 생성됨)
- Column은 데이터 표시용이 아니라 구조(제목) 정의용
- 셀 안의 바인딩은 상대경로({모델명>필드명}) → 이미 상위 items가 배열을 잡고 있기 때문
```html
<Table items="{local>/persons}">
    <columns>
        <Column><Text text="Name"/></Column>
        <Column><Text text="Age"/></Column>
        <Column><Text text="Tel"/></Column>
    </columns>
    <items>
        <ColumnListItem>
            <cells>
                <Text text="{local>name}" />
                <Input value="{local>age}" />
                <Text text="{local>tel}" />
            </cells>
        </ColumnListItem>
    </items>
</Table>
```
</br>

### Table Aggregation Binding (sap.ui.table.Table) 예제 
- `sap.ui.table.Table`은 `rows`
- `rows="{모델명>/경로}"` → 배열 전체를 바인딩 (반복 구조 생성됨)
- `<t:Column>`은 데이터 표시용이 아니라 구조(제목) 정의용
- `<t:template>` 안의 바인딩은 상대경로 (`{모델명>필드명}`) → 이미 상위 `rows`가 배열을 잡고 있기 때문
```html
<t:Table rows="{local>/persons}">
    <t:columns>

        <t:Column>
            <Label text="Name" />
            <t:template>
                <Text text="{local>name}" />
            </t:template>
        </t:Column>

        <t:Column>
            <Label text="Age" />
            <t:template>
                <Text text="{local>age}" />
            </t:template>
        </t:Column>

        <t:Column>
            <Label text="Tel" />
            <t:template>
                <Text text="{local>tel}" />
            </t:template>
        </t:Column>

    </t:columns>
</t:Table>
```
